<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>五拍計算機</title>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4308184900595874"
     crossorigin="anonymous"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        
        body {
            font-family: 'Noto Sans TC', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            text-align: center;
            padding: 30px;
            margin-bottom: 0;
        }
        
        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin: 0;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .main-content {
            padding: 40px;
        }
        
        .calculator-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(79, 172, 254, 0.2);
        }
        
        .section-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #4facfe;
            margin-bottom: 20px;
            text-align: center;
            position: relative;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            border-radius: 2px;
        }
        
        .stats-table {
            margin: 0 auto 30px;
            border-collapse: collapse;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            background: white;
        }
        
        .stats-table th {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 15px 12px;
            font-weight: 600;
            text-align: center;
            font-size: 0.95rem;
        }
        
        .stats-table td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid #f0f0f0;
            background: #fafafa;
            font-weight: 500;
        }
        
        .stats-table tr:last-child td {
            border-bottom: none;
        }
        
        .stats-table td:first-child {
            background: linear-gradient(135deg, #f8f9ff 0%, #e6f3ff 100%);
            font-weight: 600;
            color: #4facfe;
        }
        
        input[type="number"] {
            width: 70px;
            padding: 8px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            text-align: center;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            background: white;
        }
        
        input[type="number"]:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
            transform: translateY(-1px);
        }
        
        input[type="number"]:hover {
            border-color: #4facfe;
        }
        
        .dev-box {
            width: 70px;
            height: 36px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.3);
        }
        
        .controls-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .control-group {
            background: linear-gradient(135deg, #f8f9ff 0%, #e6f3ff 100%);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(79, 172, 254, 0.2);
        }
        
        .control-group label {
            display: block;
            font-weight: 600;
            color: #4facfe;
            margin-bottom: 8px;
            font-size: 0.95rem;
        }
        
        select {
            width: 100%;
            padding: 10px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        select:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }
        
        select:hover {
            border-color: #4facfe;
        }
        
        .calculate-btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(79, 172, 254, 0.4);
            display: block;
            margin: 30px auto;
            min-width: 200px;
        }
        
        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(79, 172, 254, 0.5);
        }
        
        .calculate-btn:active {
            transform: translateY(0);
        }
        
        .results-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .result-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
            transition: transform 0.3s ease;
        }
        
        .result-card:hover {
            transform: translateY(-5px);
        }
        
        .result-card h3 {
            font-size: 1.1rem;
            font-weight: 500;
            margin-bottom: 10px;
            opacity: 0.9;
        }
        
        .result-value {
            font-size: 2rem;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        /* 數據表格美化 */
        .data-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(79, 172, 254, 0.2);
        }
        
        .data-table {
            margin: 20px auto;
            border-collapse: collapse;
            width: 100%;
            max-width: 400px;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        
        .data-table thead {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        .data-table th {
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: 600;
            font-size: 1rem;
        }
        
        .data-table td {
            padding: 12px 15px;
            text-align: center;
            font-weight: 500;
            border-bottom: 1px solid rgba(79, 172, 254, 0.1);
        }
        
        .data-table tr:last-child td {
            border-bottom: none;
        }
        
        /* 漸層藍色系 */
        .group-1 { background: linear-gradient(135deg, #f0f8ff 0%, #e6f3ff 100%); }
        .group-2 { background: linear-gradient(135deg, #e6f2ff 0%, #ddeeff 100%); }
        .group-3 { background: linear-gradient(135deg, #ddeeff 0%, #d4e9ff 100%); }
        .group-4 { background: linear-gradient(135deg, #d4e9ff 0%, #cae4ff 100%); }
        .group-5 { background: linear-gradient(135deg, #cae4ff 0%, #c1dfff 100%); }
        .group-6 { background: linear-gradient(135deg, #c1dfff 0%, #b8daff 100%); }
        .group-7 { background: linear-gradient(135deg, #b8daff 0%, #aed5ff 100%); }
        .group-8 { background: linear-gradient(135deg, #aed5ff 0%, #a5d0ff 100%); }
        .group-9 { background: linear-gradient(135deg, #a5d0ff 0%, #9ccbff 100%); }
        .group-10 { background: linear-gradient(135deg, #9ccbff 0%, #92c6ff 100%); }
        .group-11 { background: linear-gradient(135deg, #92c6ff 0%, #89c1ff 100%); }
        .group-12 { background: linear-gradient(135deg, #89c1ff 0%, #80bcff 100%); }
        .group-13 { background: linear-gradient(135deg, #80bcff 0%, #76b7ff 100%); }
        .group-14 { background: linear-gradient(135deg, #76b7ff 0%, #6db2ff 100%); }
        .group-15 { background: linear-gradient(135deg, #6db2ff 0%, #64adff 100%); }
        
        /* 響應式設計 */
        @media (max-width: 768px) {
            .main-content {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .controls-section {
                grid-template-columns: 1fr;
            }
            
            .stats-table th,
            .stats-table td {
                padding: 8px 6px;
                font-size: 0.9rem;
            }
            
            input[type="number"],
            .dev-box {
                width: 60px;
            }
        }
        
        /* 動畫效果 */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .calculator-section,
        .data-section {
            animation: fadeInUp 0.6s ease-out;
        }
        
        .data-section {
            animation-delay: 0.2s;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>五拍計算機</h1>
        </div>
        
        <div class="main-content">
            <div class="calculator-section">
                <div class="section-title">球員屬性設定</div>
                
                <table class="stats-table">
                    <thead>
                        <tr>
                            <th></th>
                            <th>接觸</th>
                            <th>力量</th>
                            <th>選球</th>
                            <th>速度</th>
                            <th>守備</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>上升量</td>
                            <td><input type="number" id="GI_contact" min="0" max="30"></td>
                            <td><input type="number" id="GI_power" min="0" max="30"></td>
                            <td><input type="number" id="GI_selection" min="0" max="30"></td>
                            <td><input type="number" id="GI_speed" min="0" max="30"></td>
                            <td><input type="number" id="GI_defense" min="0" max="30"></td>
                        </tr>
                        <tr>
                            <td>基礎值</td>
                            <td><input type="number" id="base_contact"></td>
                            <td><input type="number" id="base_power"></td>
                            <td><input type="number" id="base_selection"></td>
                            <td><input type="number" id="base_speed"></td>
                            <td><input type="number" id="base_defense"></td>
                        </tr>
                        <tr>
                            <td>強化量</td>
                            <td><span class="dev-box" id="dev_contact">0</span></td>
                            <td><span class="dev-box" id="dev_power">0</span></td>
                            <td><span class="dev-box" id="dev_selection">0</span></td>
                            <td><span class="dev-box" id="dev_speed">0</span></td>
                            <td><span class="dev-box" id="dev_defense">0</span></td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="controls-section">
                    <div class="control-group">
                        <label for="player_type">球員類型</label>
                        <select id="player_type" onchange="type_of_player()">
                            <option value="type">請選擇類型</option>
                            <option value="supreme">卓越</option>
                            <option value="normal">非卓越</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label for="player_level">目標等級</label>
                        <select id="player_level" onchange="select_level()">
                            <option value="max">最大等級</option>
                            <option value=83>83</option>
                            <option value=85>85</option>
                            <option value=88>88</option>
                            <option value=90>90</option>
                            <option value=93>93</option>
                            <option value=95>95</option>
                            <option value=98>98</option>
                            <option value=100>100</option>
                            <option value=103>103</option>
                            <option value=105>105</option>
                            <option value=108>108</option>
                            <option value=110>110</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label for="training1">特訓1</label>
                        <select id="training1" onchange="updateTrainingOptions()">
                            <option value="0">請選擇屬性</option>
                            <option value="contact">接觸</option>
                            <option value="power">力量</option>
                            <option value="selection">選球</option>
                            <option value="speed">速度</option>
                            <option value="defense">守備</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label for="training2">特訓2</label>
                        <select id="training2" onchange="updateTrainingOptions()">
                            <option value="0">請選擇屬性</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label for="training3">特訓3</label>
                        <select id="training3">
                            <option value="0">請選擇屬性</option>
                        </select>
                    </div>
                </div>
                
                <button class="calculate-btn" onclick="calculate()">開始計算</button>
                
                <div class="results-section">
                    <div class="result-card">
                        <h3>五拍等級</h3>
                        <div class="result-value" id="result">0</div>
                    </div>
                    <div class="result-card">
                        <h3>剩餘自由點數</h3>
                        <div class="result-value" id="freepoint">0</div>
                    </div>
                </div>
            </div>

            <div class="data-section">
                <div class="section-title">等級對應參考表</div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>等級範圍</th>
                            <th>LV7</th>
                            <th>LV8</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="group-1"><td>80-82</td><td>7</td><td>8</td></tr>
                        <tr class="group-2"><td>83-84</td><td>8</td><td>9</td></tr>
                        <tr class="group-3"><td>85</td><td>8</td><td>10</td></tr>
                        <tr class="group-4"><td>86-87</td><td>9</td><td>10</td></tr>
                        <tr class="group-5"><td>88</td><td>9</td><td>11</td></tr>
                        <tr class="group-6"><td>89</td><td>10</td><td>11</td></tr>
                        <tr class="group-7"><td>90-92</td><td>10</td><td>12</td></tr>
                        <tr class="group-8"><td>93-94</td><td>11</td><td>13</td></tr>
                        <tr class="group-9"><td>95-97</td><td>12</td><td>14</td></tr>
                        <tr class="group-10"><td>98-99</td><td>13</td><td>15</td></tr>
                        <tr class="group-11"><td>100-102</td><td>14</td><td>16</td></tr>
                        <tr class="group-12"><td>103-104</td><td>15</td><td>17</td></tr>
                        <tr class="group-13"><td>105-107</td><td>16</td><td>18</td></tr>
                        <tr class="group-14"><td>108-109</td><td>17</td><td>19</td></tr>
                        <tr class="group-15"><td>110</td><td>18</td><td>20</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        function calculate() {
            let selected_level = select_level()
            let grade_array
            let max_level
            let free_point
            let dev
            if (selected_level == "max") {
                grade_array = max_grade()
                if (grade_array == [0,0,0,0,0,0,0]){
                    grade_array = [0,0,0,0,0,"無法達成此階級",0]
                }
                max_level = grade_array[5]
                free_point = grade_array[6]
                dev = grade_array.slice(0,5)
            }
            else {
                grade_array = level_validation(selected_level)
                if (grade_array == false){
                    grade_array = [0,0,0,0,0,"無法達成此階級",0]
                }
                max_level = grade_array[5]
                free_point = grade_array[6]
                dev = grade_array.slice(0,5)
            }
            
            let stats = ['contact', 'power', 'selection', 'speed', 'defense']

            if (document.getElementById("player_type").value == "type"){
                alert("請選擇球員類型");
            }
            else if (document.getElementById("training1").value == "0" || document.getElementById("training2").value == "0" || document.getElementById("training3").value == "0"){
                alert("請選擇特訓");
            }
            else{
                stats.forEach((stat, index) => {
                    let span = document.getElementById(`dev_${stat}`);
                    if (span) {
                        span.textContent = dev[index];
                    }
                });
                
                level = document.getElementById('result');
                point = document.getElementById('freepoint');
                level.textContent = max_level;
                point.textContent = free_point;
            }
        }

        function max_grade(){
            const grade = [83,85,88,90,93,95,98,100,103,105,108,110]
            let res = [0,0,0,0,0,0,0]
            for (let i = 0;i < grade.length;i++){
                let cur_res = level_validation(grade[i])
                if (cur_res == false){
                    break
                }
                else{
                    res = cur_res
                }
            }
            return res
        }

        function level_validation(level) {
            console.log(level)
            let GI_values = getGIValues();
            let Base_values = getBaseValues();
            let free_point = type_of_player()

            let dev = [0,0,0,0,0]
            for (let i = 0; i < 5; i++) {
                let dif = Math.max((level - (GI_values[i] + Base_values[i])),0)
                dev[i] = dif
                free_point -= dif
                if (free_point < 0){
                    return false
                }
            }
            
            let training1 = document.getElementById('training1').value;
            let training2 = document.getElementById('training2').value;
            let training3 = document.getElementById('training3').value;
            let training4 = -1
            let training5 = -1
            let stats = ['contact', 'power', 'selection', 'speed', 'defense'];
            for (let i = 0; i < 5;i++){
                switch (stats[i]){
                    case training1:
                        training1 = i;
                        break
                    case training2:
                        training2 = i
                        break
                    case training3:
                        training3 = i
                        break
                    default:
                        if (training4 > training5){
                            training5 = i
                        }
                        else{
                            training4 = i
                        }
                        break
                }
            }
            let train_array = [training1,training2,training3]
            let max_dev_index = (dev[training4] > dev[training5]) ? training4 : training5;
            for (let i = 0;i < 3; i++){
                let dev_diff = Math.max(dev[max_dev_index]- dev[train_array[i]],0)
                dev[train_array[i]] +=  dev_diff
                free_point -= dev_diff
            }
            if (free_point < 0){
                return false
            }
            
            for (let i = 1;i >= 0; i--){
                let train_diff = dev[train_array[i+1]] > dev[train_array[i]] ? dev[train_array[i+1]] - dev[train_array[i]]:0
                dev[train_array[i]] += train_diff
                free_point -= train_diff

                if ((Base_values[train_array[i]] < Base_values[train_array[i+1]]) && dev[train_array[i+1]] == dev[train_array[i]]){
                    dev[train_array[i]]++
                    free_point--
                }
                if (free_point < 0){
                    return false
                }
            }
            
            return dev.concat([level,free_point])
        }

        function type_of_player() {
            let dev; 
            switch (document.getElementById("player_type").value) {
                case "type":
                    dev = 0;
                    break;
                case "supreme":
                    dev = 87;
                    break;
                case "normal":
                    dev = 57;
                    break;
                default:
                    dev = 0;
                    break;
            }
            return dev
        }

        function select_level() {
            if (document.getElementById("player_level").value == "max"){
                return "max"
            } 
            else{
                return Number(document.getElementById("player_level").value)
            }
        }

        function getGIValues() {
            return ['contact', 'power', 'selection', 'speed', 'defense'].map(stat => {
                let GI = parseFloat(document.getElementById(`GI_${stat}`).value) || 0;
                return GI;
            });
        }

        function getBaseValues() {
            return ['contact', 'power', 'selection', 'speed', 'defense'].map(stat => {
                let base = parseFloat(document.getElementById(`base_${stat}`).value) || 0;
                return base;
            });
        }

        function updateTrainingOptions() {
            let allOptions = ['contact', 'power', 'selection', 'speed', 'defense'];
            let selected1 = document.getElementById('training1').value;
            let selected2 = document.getElementById('training2').value;
            
            let training2 = document.getElementById('training2');
            let training3 = document.getElementById('training3');
            
            let availableOptions2 = allOptions.filter(opt => opt !== selected1);
            let availableOptions3 = availableOptions2.filter(opt => opt !== selected2);
            
            training2.innerHTML = '<option value="0">請選擇屬性</option>' + availableOptions2.map(opt => `<option value="${opt}" ${opt === selected2 ? 'selected' : ''}>${translateOption(opt)}</option>`).join('');
            training3.innerHTML = '<option value="0">請選擇屬性</option>' + availableOptions3.map(opt => `<option value="${opt}">${translateOption(opt)}</option>`).join('');
        }

        function translateOption(option) {
            let translations = {
                'contact': '接觸',
                'power': '力量',
                'selection': '選球',
                'speed': '速度',
                'defense': '守備'
            };
            return translations[option] || option;
        }
    </script>
</body>
</html>