<!DOCTYPE html>
<html lang="zh-Hant">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>9INNINGS25 Skill-emulator</title>
  <style>
    /* ===== navigation.css ===== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Noto Sans TC', Arial, sans-serif;
      background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
      min-height: 100vh;
      color: white;
    }

    .sidebar {
      position: fixed;
      left: -280px;
      top: 0;
      width: 280px;
      height: 100vh;
      background: linear-gradient(180deg, #2c3e50 0%, #34495e 100%);
      box-shadow: 2px 0 20px rgba(0,0,0,0.3);
      transition: left 0.3s ease;
      z-index: 1000;
      display: flex;
      flex-direction: column;
    }

    .sidebar.active {
      left: 0;
    }

    .sidebar-header {
      padding: 25px 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 2px solid rgba(255,255,255,0.1);
    }

    .sidebar-header h2 {
      color: white;
      font-size: 1.5rem;
      font-weight: 700;
    }

    .close-btn {
      background: none;
      border: none;
      color: white;
      font-size: 1.8rem;
      cursor: pointer;
      padding: 5px 10px;
      border-radius: 5px;
      transition: background 0.3s ease;
      line-height: 1;
    }

    .close-btn:hover {
      background: rgba(255,255,255,0.1);
    }

    .sidebar-nav {
      flex: 1;
      padding: 20px 0;
      overflow-y: auto;
    }

    .nav-item {
      display: flex;
      align-items: center;
      padding: 15px 25px;
      color: rgba(255,255,255,0.8);
      text-decoration: none;
      transition: all 0.3s ease;
      margin: 5px 15px;
      border-radius: 10px;
      font-size: 1.05rem;
    }

    .nav-item:hover {
      background: rgba(255,255,255,0.1);
      color: white;
      transform: translateX(5px);
    }

    .nav-item.active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }

    .nav-icon {
      font-size: 1.5rem;
      margin-right: 15px;
      width: 30px;
      text-align: center;
    }

    .nav-text {
      font-weight: 500;
    }

    .sidebar-footer {
      padding: 20px;
      border-top: 1px solid rgba(255,255,255,0.1);
      text-align: center;
    }

    .sidebar-footer p {
      color: rgba(255,255,255,0.5);
      font-size: 0.9rem;
    }

    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      z-index: 999;
    }

    .overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .main-content {
      transition: margin-left 0.3s ease;
    }

    .menu-toggle {
      position: fixed;
      top: 20px;
      left: 20px;
      width: 50px;
      height: 50px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: none;
      border-radius: 12px;
      cursor: pointer;
      z-index: 998;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 6px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
      transition: all 0.3s ease;
    }

    .menu-toggle:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
    }

    .menu-toggle span {
      width: 25px;
      height: 3px;
      background: white;
      border-radius: 2px;
      transition: all 0.3s ease;
    }

    .menu-toggle:hover span {
      width: 30px;
    }

    .sidebar-nav::-webkit-scrollbar { width: 6px; }
    .sidebar-nav::-webkit-scrollbar-track { background: rgba(255,255,255,0.05); }
    .sidebar-nav::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 3px; }
    .sidebar-nav::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.3); }

    @media (max-width: 768px) {
      .sidebar { width: 100%; left: -100%; }
      .menu-toggle { top: 15px; left: 15px; width: 45px; height: 45px; }
    }

    @media (min-width: 1200px) {
      .sidebar.active { left: 0; }
      .main-content { margin-left: 0; transition: margin-left 0.3s ease; }
      .main-content.sidebar-open { margin-left: 280px; }
      .overlay { display: none; }
      .menu-toggle { display: flex; }
    }

    /* ===== skill.css reset ===== */
    html, body, div, span, applet, object, iframe,
    h1, h2, h3, h4, h5, h6, p, blockquote, pre,
    a, abbr, acronym, address, big, cite, code,
    del, dfn, em, img, ins, kbd, q, s, samp,
    small, strike, strong, sub, sup, tt, var,
    b, u, i, center,
    dl, dt, dd, ol, ul, li,
    fieldset, form, label, legend,
    table, caption, tbody, tfoot, thead, tr, th, td,
    article, aside, canvas, details, embed, 
    figure, figcaption, footer, header, hgroup, 
    menu, nav, output, ruby, section, summary,
    time, mark, audio, video {
      margin: 0;
      padding: 0;
      border: 0;
      font-size: 100%;
      font: inherit;
      vertical-align: baseline;
    }
    article, aside, details, figcaption, figure, 
    footer, header, hgroup, menu, nav, section { display: block; }
    body { line-height: 1; }
    ol, ul { list-style: none; }
    blockquote, q { quotes: none; }
    blockquote:before, blockquote:after, q:before, q:after { content: ''; content: none; }
    table { border-collapse: collapse; border-spacing: 0; }

    /* ===== skill.css main styles ===== */
    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: #000000;
      user-select: none;
      overflow: auto;
    }

    .main-content {
      width: 100%;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
      box-sizing: border-box;
    }

    .container {
      display: flex;
      gap: 40px;
      flex-wrap: wrap;
      justify-content: center;
      align-items: center;
      max-width: 100%;
      margin: auto;
    }

    .skill-box-left, .skill-box-right {
      width: 300px;
      height: 500px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .card1, .card2 {
      position: relative;
      top: 15px;
      width: 300px;
      height: 450px;
      background-color: #444;
    }

    .hover-effect { cursor: pointer; }

    .choose-skill {
      background-color: rgba(74, 121, 231, 0.4);
      outline: 2px solid #3975dd;
      z-index: 100;
      cursor: pointer;
    }

    .select-skill {
      width: 300px;
      height: 40px;
      background-color: #5f76b8;
      color: #ffffff;
      font-size: 25px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 500;
    }

    .choose-skill-container {
      position: fixed;
      flex-direction: column;
      align-items: center;
      justify-content: stretch;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 800px;
      height: 550px;
      background: linear-gradient(to bottom, #b6b4b4, #b5b2b2);
      border: 1px solid #555;
      z-index: 1000;
    }

    .choose-skill-banner {
      width: 100%;
      height: 15%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 500;
      font-size: 30px;
      color: #363535;
      background-color: #ddd9d9;
    }

    .choose-skill-text {
      width: 100%;
      height: 75%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 25px;
      font-weight: 500;
      color: #444242;
    }

    .skill-box {
      width: 95%;
      height: 40%;
      position: absolute;
      bottom: 5px;
      left: 50%;
      transform: translateX(-50%);
      background-color: #000000;
      border: 2px solid #000000;
      z-index: 5;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .skill-1, .skill-2, .skill-3 {
      width: calc(100% - 2px);
      display: flex;
      align-items: center;
      justify-content: center;
      background-size: cover;
      background-position: center;
      height: 33.3%;
      margin: 2px;
      font-weight: 500;
      background-color: #FFFFFF;
      color: rgb(221, 215, 215);
      font-style: italic;
      font-size: 20px;
      text-shadow: 0 0 5px black, 0 0 5px black, 0 0 5px black;
    }

    .skill-changes {
      width: 400px;
      height: 500px;
      overflow-y: auto;
      background-color: #282727;
      border: 1px solid #555;
      padding: 3px;
      box-sizing: border-box;
      display: block;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .skill-changes::-webkit-scrollbar { display: none; }

    .skill-change {
      background: rgb(171, 171, 174);
      margin-bottom: 5px;
      height: 80px;
      display: flex;
      align-items: center;
      position: relative;
      font-weight: 500;
    }

    .skill-change:hover { cursor: pointer; }

    .skill-change div:nth-child(1) {
      width: 80px;
      height: 80px;
      background-color: #787474;
      margin-right: 10px;
      flex-shrink: 0;
    }

    .skill-change div:nth-child(2) {
      color: #000000;
      font-size: 20px;
      width: 50%;
    }

    .skill-change div:nth-child(3) {
      width: 1px;
      height: 65px;
      background-color: #e9dfdf;
      display: inline-block;
      margin: 0 10px 0 30px;
    }

    .skill-change div:nth-child(4) { font-size: 25px; }

    .skill-change .mask {
      position: absolute;
      top: 0;
      left: 0;
      width: 99.5%;
      height: 99%;
      background-color: rgba(74, 121, 231, 0.4);
      outline: 2px solid #3975dd;
      border: 1.5px solid #3975dd;
      pointer-events: none;
      z-index: 10;
    }

    .confirm-box {
      position: fixed;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: stretch;
      top: 50%;
      left: 50%;
      gap: 10px;
      transform: translate(-50%, -50%);
      width: 800px;
      height: 500px;
      background-color: #a49e9e;
      border: 1px solid #555;
      z-index: 10;
    }

    .name-banner {
      width: 100%;
      height: 70px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 25px;
      background-color: #e2d6d6;
    }

    .skill-box-banner {
      width: 100%;
      height: 10%;
      display: flex;
      align-items: center;
      font-size: 20px;
      color: #ffffff;
      justify-content: center;
      background-color: #c40a0a;
      margin-bottom: 10px;
    }

    .skill-box-original-1, .skill-box-original-2, .skill-box-original-3 {
      width: 300px;
      height: 90%;
      display: flex;
      align-items: center;
      justify-content: center;
      background-size: cover;
      background-position: center;
      margin: 3px;
      background-color: #FFFFFF;
      color: rgb(221, 215, 215);
      font-style: italic;
      font-size: 20px;
      text-shadow: 0 0 5px black, 0 0 5px black, 0 0 5px black;
    }

    .btn-box {
      width: 100%;
      height: 70px;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: #e2d6d6;
    }

    .btn-1, .selection-btn-1 {
      width: 200px;
      height: 65%;
      background-color: #4b5383;
      margin-right: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      border: none;
      color: #ffffff;
    }

    .btn-2, .selection-btn-2 {
      width: 200px;
      height: 65%;
      background-color: rgb(27, 27, 206);
      margin-left: 5px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      border: none;
      color: #ffffff;
    }

    .btn-2:hover, .btn-1:hover, .selection-btn-2:hover, .selection-btn-1:hover { cursor: pointer; }

    .text {
      width: 50%;
      height: 20%;
      margin-top: 15px;
      font-size: 17px;
      text-align: center;
      line-height: 1.5;
    }

    .text span {
      display: inline;
      color: #4c0665;
      font-weight: bold;
    }

    .use-skill-changes-container {
      width: 100%;
      height: 100px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .use-skill-changes {
      width: 90%;
      height: 60%;
      display: flex;
      align-items: center;
      justify-content: space-around;
      background-image: url('pics/skill-change-use.png');
      background-size: cover;
      background-position: center;
      border: none;
    }

    .use-skill-changes:hover { cursor: pointer; }

    .skill-change-icon { background-image: url('pics/skill-change.png'); width: 100%; height: 100%; background-size: cover; background-position: center; }
    .ultimate-skill-change-icon { background-image: url('pics/ultimate-skill-change.png'); width: 100%; height: 100%; background-size: cover; background-position: center; }
    .legend-skill-change-icon { background-image: url('pics/legend-skill-change.png'); width: 100%; height: 100%; background-size: cover; background-position: center; }
    .legend-skill-select-change-icon { background-image: url('pics/legend-skill-select-change.png'); width: 100%; height: 100%; background-size: cover; background-position: center; }
    .skill-select-change-icon { background-image: url('pics/skill-select-change.png'); width: 100%; height: 100%; background-size: cover; background-position: center; }
    .premium-skill-select-change-icon { background-image: url('pics/premium-skill-select-change.png'); width: 100%; height: 100%; background-size: cover; background-position: center; }
    .skill-protect-change-icon { background-image: url('pics/skill-protect-change.png'); width: 100%; height: 100%; background-size: cover; background-position: center; }
    .premium-skill-protect-change-icon { background-image: url('pics/premium-skill-protect-change.png'); width: 100%; height: 100%; background-size: cover; background-position: center; }

    .skill-box1, .skill-box2, .skill-box3 {
      width: 50%;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .selection-box-banner {
      width: 100%;
      height: 70px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 25px;
      margin-bottom: 15px;
      font-weight: 500;
      background-color: #e2d6d6;
    }

    .selection-skill-box-original-1, .selection-skill-box-original-2, .selection-skill-box-original-3 {
      width: 300px;
      height: 80%;
      display: flex;
      align-items: center;
      justify-content: center;
      background-size: cover;
      background-position: center;
      margin: 3px;
      background-color: #FFFFFF;
      color: rgb(221, 215, 215);
      font-style: italic;
      font-size: 20px;
      text-shadow: 0 0 5px black, 0 0 5px black, 0 0 5px black;
    }

    .selection-skill-box1, .selection-skill-box2, .selection-skill-box3 {
      width: 100%;
      height: 60px;
      display: flex;
      align-items: center;
    }

    svg { background-size: cover; background-position: center; margin-bottom: 10px; }

    .line { border: none; height: 0.5px; background-color: #838181; width: 85%; }

    .selection-footer {
      width: 100%;
      height: 70px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: 10px;
      background-color: #e2d6d6;
    }

    .switch {
      position: fixed;
      top: 80px;
      left: 20px;
      display: flex;
      align-items: center;
      cursor: pointer;
      user-select: none;
      z-index: 997;
      background: rgba(0, 0, 0, 0.7);
      padding: 8px 12px;
      border-radius: 25px;
      backdrop-filter: blur(10px);
    }

    .switch input { display: none; }

    .slider {
      position: relative;
      width: 50px;
      height: 24px;
      background-color: #ccc;
      border-radius: 12px;
      transition: background-color 0.3s;
    }

    .slider::before {
      content: "";
      position: absolute;
      width: 20px;
      height: 20px;
      left: 2px;
      top: 2px;
      background-color: white;
      border-radius: 50%;
      transition: transform 0.3s;
    }

    input:checked + .slider { background-color: royalblue; }
    input:checked + .slider::before { transform: translateX(26px); }

    .label-text {
      margin-left: 10px;
      font-weight: bold;
      user-select: none;
    }

    .selection-container {
      position: fixed;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: space-between;
      top: 50%;
      left: 50%;
      gap: 10px;
      transform: translate(-50%, -50%);
      width: 800px;
      height: 500px;
      background-color: #a49e9e;
      border: 1px solid #555;
      z-index: 100;
    }

    /* ===== 彈出視窗 fixed + scroll ===== */
    .choose-skill-container,
    .confirm-box,
    .selection-container {
      position: fixed;
      max-height: 90vh;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }

    .choose-skill-container::-webkit-scrollbar,
    .confirm-box::-webkit-scrollbar,
    .selection-container::-webkit-scrollbar { width: 8px; }

    .choose-skill-container::-webkit-scrollbar-track,
    .confirm-box::-webkit-scrollbar-track,
    .selection-container::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.1); }

    .choose-skill-container::-webkit-scrollbar-thumb,
    .confirm-box::-webkit-scrollbar-thumb,
    .selection-container::-webkit-scrollbar-thumb { background: rgba(255, 255, 255, 0.3); border-radius: 4px; }

    /* ===== 響應式 ===== */
    @media (max-width: 1024px) and (orientation: landscape) {
      body { padding: 15px 0; }
      .main-content { padding: 15px; min-height: auto; }
      .container { gap: 30px; transform: scale(0.85); }
      .switch { top: 70px; left: 15px; transform: scale(0.9); }
      .skill-box-left, .skill-box-right { width: 250px !important; height: 420px !important; }
      .card1, .card2 { width: 250px !important; height: 380px !important; }
      .select-skill { height: 35px !important; font-size: 20px !important; }
    }

    @media (max-width: 768px) and (orientation: landscape) {
      body { padding: 10px 0; }
      .main-content { padding: 10px; min-height: auto; }
      .container { gap: 20px; transform: scale(0.7); }
      .switch { top: 65px; left: 10px; transform: scale(0.85); }
      .skill-box-left, .skill-box-right { width: 220px !important; height: 370px !important; }
      .card1, .card2 { width: 220px !important; height: 330px !important; }
      .select-skill { height: 30px !important; font-size: 18px !important; }
      .skill-changes-container { transform: scale(0.9); }
      .choose-skill-container, .confirm-box, .selection-container { width: 90vw !important; max-width: 700px !important; height: auto !important; max-height: 85vh !important; overflow-y: auto; }
    }

    @media (max-width: 768px) and (orientation: portrait) {
      .main-content { padding: 80px 15px 20px; min-height: 100vh; }
      .container { flex-direction: column; gap: 30px; }
      .switch { top: 75px; left: 15px; }
      .skill-box-left, .skill-box-right { width: 280px !important; height: 470px !important; }
      .card1, .card2 { width: 280px !important; height: 420px !important; }
      .skill-changes-container { width: 100%; max-width: 350px; }
      .skill-changes { height: 400px !important; }
      .choose-skill-container, .confirm-box, .selection-container { width: 90vw !important; max-width: 350px !important; height: auto !important; max-height: 80vh !important; overflow-y: auto; }
    }

    @media (max-height: 500px) and (orientation: landscape) {
      .container { transform: scale(0.6); gap: 15px; }
      .switch { top: 55px; left: 8px; transform: scale(0.75); }
      .skill-box-left, .skill-box-right { width: 200px !important; height: 330px !important; }
      .card1, .card2 { width: 200px !important; height: 290px !important; }
      .select-skill { height: 28px !important; font-size: 16px !important; }
    }
  </style>
</head>

<body>
  <!-- sidebar 由 navigation.js 動態載入 sidebar.html -->

  <!-- 主內容 -->
  <div class="main-content">
    <label class="switch">
      <input type="checkbox" id="toggleSwitch" onclick="toggleSkill(this)" />
      <span class="slider"></span>
      <span class="label-text" id="labelText">打者</span>
    </label>
    <div class="container">
      <div class="selection-container" style="display: none;">
        <div class="selection-box-banner"></div>
        <div class="skill-box1" onclick="select_svg(this)">
          <div class="selection-skill-box1">
            <svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="50.0pt" height="50.0pt" viewBox="0 0 105.000000 99.000000" preserveAspectRatio="xMidYMid meet">
              <g transform="translate(0.000000,99.000000) scale(0.100000,-0.100000)" fill="#051350" stroke="none">
                <path class="p1" fill="＃051350" d="M894 728 c-22 -18 -126 -111 -231 -205 -106 -95 -198 -173 -204 -173 -6 0 -60 36 -120 80 -60 44 -116 83 -125 87 -14 5 -15 3 -4 -17 28 -52 243 -370 250 -370 9 0 66 72 309 393 95 126 171 231 168 233 -3 3 -22 -10 -43 -28z" />
                <path d="M180 661 c0 -55 3 -63 33 -90 17 -17 35 -31 39 -31 4 0 8 21 10 48 l3 47 220 5 220 5 37 30 c21 17 38 33 38 38 0 4 -135 7 -300 7 l-300 0 0 -59z" />
                <path d="M755 433 c-39 -46 -40 -50 -45 -138 l-5 -90 -72 -3 c-69 -3 -74 -5 -98 -36 -14 -18 -25 -36 -25 -40 0 -3 66 -5 148 -4 l147 3 3 169 c1 93 -1 173 -6 178 -4 4 -26 -13 -47 -39z" />
                <path d="M182 273 l3 -148 113 -3 c122 -3 126 0 92 48 -18 25 -29 29 -73 32 l-52 3 -3 75 c-3 69 -6 78 -34 108 -18 17 -36 32 -40 32 -5 0 -7 -66 -6 -147z" />
              </g>
            </svg>
            <div class="selection-skill-box-original-1"></div>
          </div>
        </div>
        <hr class="line">
        <div class="skill-box2" onclick="select_svg(this)">
          <div class="selection-skill-box2">
            <svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="50.0pt" height="50.0pt" viewBox="0 0 105.000000 99.000000" preserveAspectRatio="xMidYMid meet">
              <g transform="translate(0.000000,99.000000) scale(0.100000,-0.100000)" fill="#051350" stroke="none">
                <path class="p2" fill="＃051350" d="M894 728 c-22 -18 -126 -111 -231 -205 -106 -95 -198 -173 -204 -173 -6 0 -60 36 -120 80 -60 44 -116 83 -125 87 -14 5 -15 3 -4 -17 28 -52 243 -370 250 -370 9 0 66 72 309 393 95 126 171 231 168 233 -3 3 -22 -10 -43 -28z" />
                <path d="M180 661 c0 -55 3 -63 33 -90 17 -17 35 -31 39 -31 4 0 8 21 10 48 l3 47 220 5 220 5 37 30 c21 17 38 33 38 38 0 4 -135 7 -300 7 l-300 0 0 -59z" />
                <path d="M755 433 c-39 -46 -40 -50 -45 -138 l-5 -90 -72 -3 c-69 -3 -74 -5 -98 -36 -14 -18 -25 -36 -25 -40 0 -3 66 -5 148 -4 l147 3 3 169 c1 93 -1 173 -6 178 -4 4 -26 -13 -47 -39z" />
                <path d="M182 273 l3 -148 113 -3 c122 -3 126 0 92 48 -18 25 -29 29 -73 32 l-52 3 -3 75 c-3 69 -6 78 -34 108 -18 17 -36 32 -40 32 -5 0 -7 -66 -6 -147z" />
              </g>
            </svg>
            <div class="selection-skill-box-original-2"></div>
          </div>
        </div>
        <hr class="line">
        <div class="skill-box3" onclick="select_svg(this)">
          <div class="selection-skill-box3">
            <svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="50.0pt" height="50.0pt" viewBox="0 0 105.000000 99.000000" preserveAspectRatio="xMidYMid meet">
              <g transform="translate(0.000000,99.000000) scale(0.100000,-0.100000)" fill="#051350" stroke="none">
                <path class="p3" fill="＃051350" d="M894 728 c-22 -18 -126 -111 -231 -205 -106 -95 -198 -173 -204 -173 -6 0 -60 36 -120 80 -60 44 -116 83 -125 87 -14 5 -15 3 -4 -17 28 -52 243 -370 250 -370 9 0 66 72 309 393 95 126 171 231 168 233 -3 3 -22 -10 -43 -28z" />
                <path d="M180 661 c0 -55 3 -63 33 -90 17 -17 35 -31 39 -31 4 0 8 21 10 48 l3 47 220 5 220 5 37 30 c21 17 38 33 38 38 0 4 -135 7 -300 7 l-300 0 0 -59z" />
                <path d="M755 433 c-39 -46 -40 -50 -45 -138 l-5 -90 -72 -3 c-69 -3 -74 -5 -98 -36 -14 -18 -25 -36 -25 -40 0 -3 66 -5 148 -4 l147 3 3 169 c1 93 -1 173 -6 178 -4 4 -26 -13 -47 -39z" />
                <path d="M182 273 l3 -148 113 -3 c122 -3 126 0 92 48 -18 25 -29 29 -73 32 l-52 3 -3 75 c-3 69 -6 78 -34 108 -18 17 -36 32 -40 32 -5 0 -7 -66 -6 -147z" />
              </g>
            </svg>
            <div class="selection-skill-box-original-3"></div>
          </div>
        </div>
        <div class="selection-footer">
          <div class="selection-btn-1" onclick="document.querySelector('.selection-container').style.display = 'none';document.querySelector('.switch').style.display = 'flex';">否</div>
          <button class="selection-btn-2" onclick="ChangeSkill();">是</button>
        </div>
      </div>

      <div class="choose-skill-container" style="display: none;">
        <div class="choose-skill-banner">變更技能</div>
        <div class="choose-skill-text">您確定要變更為新的技能嗎?</div>
        <div class="btn-box">
          <button class="btn-1" onclick="closeChooseSkillContainer()">否</button>
          <button class="btn-2" onclick="replaceSkill()">是</button>
        </div>
      </div>

      <div class="skill-box-left">
        <div class="select-skill" style="display: none;">保留技能</div>
        <div class="card1" onclick="chooseSkill(this)">
          <div class="skill-box">
            <div class="skill-1"></div>
            <div class="skill-2"></div>
            <div class="skill-3"></div>
          </div>
        </div>
      </div>

      <div class="skill-box-right" style="display: none;">
        <div class="select-skill">變更技能</div>
        <div class="card2" onclick="chooseSkill(this)">
          <div class="skill-box">
            <div class="skill-1"></div>
            <div class="skill-2"></div>
            <div class="skill-3"></div>
          </div>
        </div>
      </div>

      <div class="skill-changes-container" style="display: block;">
        <div class="skill-changes">
          <div class="skill-change" onclick="toggleOverlay(this)">
            <div class="skill-change-icon"></div>
            <div>高級技能變更券</div>
            <div></div>
            <div>x100</div>
            <div class="mask" style="display:block;"></div>
          </div>
          <div class="skill-change" onclick="toggleOverlay(this)">
            <div class="ultimate-skill-change-icon"></div>
            <div>最高級技能變更券</div>
            <div></div>
            <div>x100</div>
            <div class="mask" style="display: none;"></div>
          </div>
          <div class="skill-change" onclick="toggleOverlay(this)">
            <div class="legend-skill-change-icon"></div>
            <div>傳說技能變更券</div>
            <div></div>
            <div>x100</div>
            <div class="mask" style="display: none;"></div>
          </div>
          <div class="skill-change" onclick="toggleOverlay(this)">
            <div class="legend-skill-select-change-icon"></div>
            <div>傳說技能選擇變更券</div>
            <div></div>
            <div>x100</div>
            <div class="mask" style="display: none;"></div>
          </div>
          <div class="skill-change" onclick="toggleOverlay(this)">
            <div class="skill-select-change-icon"></div>
            <div>技能選擇變更券</div>
            <div></div>
            <div>x100</div>
            <div class="mask" style="display: none;"></div>
          </div>
          <div class="skill-change" onclick="toggleOverlay(this)">
            <div class="premium-skill-select-change-icon"></div>
            <div>高級技能選擇變更券</div>
            <div></div>
            <div>x100</div>
            <div class="mask" style="display: none;"></div>
          </div>
          <div class="skill-change" onclick="toggleOverlay(this)">
            <div class="skill-protect-change-icon"></div>
            <div>技能變更保護券</div>
            <div></div>
            <div>x100</div>
            <div class="mask" style="display: none;"></div>
          </div>
          <div class="skill-change" onclick="toggleOverlay(this)">
            <div class="premium-skill-protect-change-icon"></div>
            <div>高級技能變更保護券</div>
            <div></div>
            <div>x100</div>
            <div class="mask" style="display: none;"></div>
          </div>
        </div>
        <div class="use-skill-changes-container">
          <button class="use-skill-changes" onclick="use_skill()"></button>
        </div>
      </div>
    </div>
    <!-- /container -->

    <div class="confirm-box" style="display: none;">
      <div class="name-banner">高級技能變更券</div>
      <div class="skill-box-banner">技能保管箱1</div>
      <div class="skill-box1">
        <div class="skill-box-original-1"></div>
      </div>
      <div class="skill-box2">
        <div class="skill-box-original-2"></div>
      </div>
      <div class="skill-box3">
        <div class="skill-box-original-3"></div>
      </div>
      <div class="text">請問要在
        <span>S.Ohtani'24</span>
        球員上使用技能變更券嗎？<br>
        全部的技能將會隨機產生，<br>
        且技能經驗值和技能強化次數也會被初始化。<br>
      </div>
      <div class="btn-box">
        <div class="btn-1" onclick="document.querySelector('.confirm-box').style.display = 'none';document.querySelector('.switch').style.display = 'flex';">否</div>
        <button class="btn-2" onclick="ChangeSkill()">是</button>
      </div>
    </div>
  </div>

  <script>
    /* ===== navigation.js ===== */
    function loadSidebar() {
      fetch('sidebar.html')
        .then(response => response.text())
        .then(data => {
          document.body.insertAdjacentHTML('afterbegin', data);
          setActiveNavItem();
          initializeSidebar();
        })
        .catch(error => console.error('載入側邊欄失敗:', error));
    }

    function toggleSidebar() {
      const sidebar = document.getElementById('sidebar');
      const overlay = document.getElementById('overlay');
      const mainContent = document.querySelector('.main-content');
      sidebar.classList.toggle('active');
      overlay.classList.toggle('active');
      if (window.innerWidth >= 1200 && mainContent) {
        mainContent.classList.toggle('sidebar-open');
      }
    }

    function setActiveNavItem() {
      const currentPage = window.location.pathname.split('/').pop() || 'index.html';
      document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
        const href = item.getAttribute('href');
        if (href === currentPage || (currentPage === '' && href === 'index.html')) {
          item.classList.add('active');
        }
      });
    }

    function initializeSidebar() {
      const sidebar = document.getElementById('sidebar');
      const mainContent = document.querySelector('.main-content');
      if (window.innerWidth >= 1200) {
        if (sidebar) sidebar.classList.remove('active');
        if (mainContent) mainContent.classList.remove('sidebar-open');
      }
    }

    window.addEventListener('resize', function() {
      const sidebar = document.getElementById('sidebar');
      const overlay = document.getElementById('overlay');
      const mainContent = document.querySelector('.main-content');
      if (window.innerWidth >= 1200) {
        if (overlay) overlay.classList.remove('active');
      } else {
        if (mainContent) mainContent.classList.remove('sidebar-open');
      }
    });

    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('overlay');
        const mainContent = document.querySelector('.main-content');
        if (sidebar && sidebar.classList.contains('active')) {
          sidebar.classList.remove('active');
          if (overlay) overlay.classList.remove('active');
          if (mainContent) mainContent.classList.remove('sidebar-open');
        }
      }
    });

    /* ===== skill.js ===== */
    const B_legend_skill = ["精準打擊", "先鋒", "壞球打者", "天生巨星", "打者默契", "打者洞察力","最強打者","機會製造者","老手"];
    const B_gold_skill = ["強化優點","預知能力","超能神話","雷射肩","超級強打","廣角打者","萬眾矚目","五拍子球員","超級輔助","王牌殺手","打擊機器","盜壘天王","自走砲"];
    const B_silver_skill = ["精密打擊", "揮大棒打者", "巨砲本能", "開路先鋒", "筋疲力盡", "忍術","下盤鍛鍊", "逆轉的力量", "勝負天性", "動物本能", "信賴", "克服弱點"];
    const B_bronze_skill = ["代打專家", "鷹眼", "推打", "拉打", "左腕殺手", "右腕殺手", "守備將軍","打點機器", "直球殺手", "正面對決", "集中力", "初球攻略"];
    const P_legend_skill = ["工作馬","精準控球","速球型投手","完美先生","牛棚日","投手默契","投手洞察力","合力投球","先守後攻"];
    const P_gold_skill = ["技巧派投手","壓倒性投手","大吃局數","最後大魔王","交錯之火","自我解決","王牌","鬥志","王牌終結者","滾地球投手","巨人殺手","投球協調者","決勝球","無法碰觸"];
    const P_silver_skill = ["強力投手","控球藝術家","強打殺手","國寶投手","逆轉大師","狙擊手","野戰指揮","投球機器","佈局","乘勝追擊","救火隊","安全感","調整節奏"];
    const P_bronze_skill = ["牽制王","平靜","佛祖保佑","危機克服","光速投球","魔球大師","左打殺手","右打殺手","鋼鐵人","老謀深算","強心臟","冰凍"];

    function initializeSkillBoxes() {
      const skillPools = getSkillPools();
      const leftCard = document.querySelector('.skill-box-left .card1');
      const skillBoxes = leftCard.querySelectorAll('.skill-1, .skill-2, .skill-3');
      const baseProbabilities = { legend: 0.1 };
      const skillCategories = {
        legend: { list: skillPools.legend, image: 'url(pics/legend.png)', probability: baseProbabilities.legend },
        gold: { list: skillPools.gold, image: 'url(pics/gold.png)' },
        silver: { list: skillPools.silver, image: 'url(pics/silver.png)' },
        bronze: { list: skillPools.bronze, image: 'url(pics/bronze.png)' }
      };
      function getRandomSkillFrom(categoryList) {
        return categoryList[Math.floor(Math.random() * categoryList.length)];
      }
      function selectCategory(index) {
        if (index === 0 && Math.random() < skillCategories.legend.probability) return 'legend';
        const normalKeys = ['gold', 'silver', 'bronze'];
        return normalKeys[Math.floor(Math.random() * normalKeys.length)];
      }
      for (let i = 0; i < skillBoxes.length; i++) {
        let category = selectCategory(i);
        let skill = getRandomSkillFrom(skillCategories[category].list);
        const level = Math.floor(Math.random() * 3) + 1;
        skillBoxes[i].textContent = `${skill}  Lv. ${level}`;
        skillBoxes[i].style.backgroundImage = skillCategories[category].image;
        skillBoxes[i].style.backgroundSize = 'cover';
      }
    }

    function reset_svg() {
      document.querySelectorAll('svg').forEach(svg => {
        svg.querySelectorAll('path').forEach(path => path.setAttribute('fill', '#051350'));
      });
    }

    function toggleSkill(el) {
      const labelText = document.getElementById('labelText');
      if (el.checked) {
        labelText.textContent = '投手';
        labelText.style.color = 'royalblue';
      } else {
        labelText.textContent = '打者';
        labelText.style.color = 'crimson';
      }
      initializeSkillBoxes();
    }

    function getSkillPools() {
      const pools = {
        B: { legend: B_legend_skill, gold: B_gold_skill, silver: B_silver_skill, bronze: B_bronze_skill },
        P: { legend: P_legend_skill, gold: P_gold_skill, silver: P_silver_skill, bronze: P_bronze_skill }
      };
      return document.getElementById('labelText').textContent === '打者' ? pools.B : pools.P;
    }

    function ChangeSkills_basic(mode) {
      const skillPools = getSkillPools();
      const new_skill = document.querySelector('.card2');
      const skillBoxes = new_skill.querySelectorAll('.skill-1, .skill-2, .skill-3');
      const usedSkills = new Set();
      const baseProbabilities = { normal: 0.1, ultimate: 0.15, legend: 1.0 };
      const skillCategories = {
        legend: { list: skillPools.legend, image: 'url(pics/legend.png)', probability: baseProbabilities[mode] || 0 },
        gold: { list: skillPools.gold, image: 'url(pics/gold.png)', probability: mode === 'ultimate' ? 0.2833 : null },
        silver: { list: skillPools.silver, image: 'url(pics/silver.png)', probability: mode === 'ultimate' ? 0.2833 : null },
        bronze: { list: skillPools.bronze, image: 'url(pics/bronze.png)', probability: mode === 'ultimate' ? 0.2833 : null }
      };
      function getRandomSkillFrom(categoryList) {
        const available = categoryList.filter(skill => !usedSkills.has(skill));
        if (available.length === 0) return null;
        const skill = available[Math.floor(Math.random() * available.length)];
        usedSkills.add(skill);
        return skill;
      }
      function selectCategory(index) {
        if (index === 0) {
          if (mode === 'legend') return 'legend';
          if (Math.random() < skillCategories.legend.probability) return 'legend';
        }
        const normalKeys = ['gold', 'silver', 'bronze'];
        return normalKeys[Math.floor(Math.random() * normalKeys.length)];
      }
      function generateSkills() {
        const results = [];
        let totalLevel = 0;
        for (let i = 0; i < skillBoxes.length; i++) {
          let category = selectCategory(i);
          let skill = getRandomSkillFrom(skillCategories[category].list);
          if (!skill) {
            const fallbackKeys = Object.keys(skillCategories).filter(k => k !== category);
            while (fallbackKeys.length > 0 && !skill) {
              const randKey = fallbackKeys.splice(Math.floor(Math.random() * fallbackKeys.length), 1)[0];
              skill = getRandomSkillFrom(skillCategories[randKey].list);
              if (skill) { category = randKey; break; }
            }
          }
          const level = Math.floor(Math.random() * 3) + 1;
          totalLevel += level;
          results.push({ box: skillBoxes[i], text: `${skill}  Lv. ${level}`, image: skillCategories[category].image });
        }
        return { results, totalLevel };
      }
      let finalResults;
      if (mode === 'ultimate') {
        do { usedSkills.clear(); finalResults = generateSkills(); } while (finalResults.totalLevel < 5);
      } else {
        finalResults = generateSkills();
      }
      finalResults.results.forEach(result => {
        result.box.textContent = result.text;
        result.box.style.backgroundImage = result.image;
        result.box.style.backgroundSize = 'cover';
      });
      document.querySelector('.confirm-box').style.display = 'none';
      document.querySelector('.card2').style.display = 'block';
      document.querySelector('.skill-changes-container').style.display = 'none';
      document.querySelector('.container').style.gap = '150px';
      document.querySelectorAll('.select-skill').forEach(skill => skill.style.display = 'flex');
      document.querySelector('.skill-box-right').style.display = 'block';
      document.querySelector('.card1').classList.add('hover-effect');
      document.querySelector('.card2').classList.add('hover-effect');
    }

    function legend_skill_select() {
      const leftBox = document.querySelector('.skill-box-left');
      const rightBox = document.querySelector('.skill-box-right');
      const skillPools = getSkillPools();
      const skillCategories = {
        legend: { list: skillPools.legend, image: 'url(pics/legend.png)' },
        gold: { image: 'url(pics/gold.png)' },
        silver: { image: 'url(pics/silver.png)' },
        bronze: { image: 'url(pics/bronze.png)' }
      };
      for (let i = 1; i <= 3; i++) {
        const leftSkill = leftBox.querySelector(`.skill-${i}`);
        const rightSkill = rightBox.querySelector(`.skill-${i}`);
        const text = leftSkill.textContent.trim();
        const levelMatch = text.match(/Lv\.\s*\d+/);
        const levelText = levelMatch ? `  ${levelMatch[0]}` : '';
        if (i === 1) {
          const leftSkillName = text.replace(/Lv\.\s*\d+/, '').trim();
          const availableSkills = skillCategories.legend.list.filter(skill => skill !== leftSkillName);
          if (availableSkills.length === 0) {
            rightSkill.textContent = text;
            rightSkill.style.backgroundImage = skillCategories.legend.image;
          } else {
            const newSkill = availableSkills[Math.floor(Math.random() * availableSkills.length)];
            rightSkill.textContent = `${newSkill}${levelText}`;
            rightSkill.style.backgroundImage = skillCategories.legend.image;
          }
        } else {
          rightSkill.textContent = text;
          rightSkill.style.backgroundImage = leftSkill.style.backgroundImage;
        }
        rightSkill.style.backgroundSize = 'cover';
      }
      document.querySelector('.confirm-box').style.display = 'none';
      document.querySelector('.card2').style.display = 'block';
      document.querySelector('.skill-changes-container').style.display = 'none';
      document.querySelector('.container').style.gap = '150px';
      document.querySelectorAll('.select-skill').forEach(skill => skill.style.display = 'flex');
      document.querySelector('.skill-box-right').style.display = 'block';
      document.querySelector('.card1').classList.add('hover-effect');
      document.querySelector('.card2').classList.add('hover-effect');
    }

    function check_legend_skill() {
      const iconClass = find_skill_type();
      if (iconClass === "legend-skill-select-change-icon") {
        const bgImage = getComputedStyle(document.querySelector('.card1 .skill-1')).backgroundImage;
        return bgImage.includes('legend.png');
      }
      return true;
    }

    function use_skill() {
      const selections = ['premium-skill-select-change-icon', 'skill-select-change-icon', 'premium-skill-protect-change-icon', 'skill-protect-change-icon'];
      document.querySelector('.switch').style.display = 'none';
      if (check_legend_skill()) {
        document.querySelector('.confirm-box').style.display = 'flex';
      } else {
        document.querySelector('.switch').style.display = 'flex';
      }
      updateSkillBox();
      if (!selections.includes(String(find_skill_type()))) {
        document.querySelectorAll('svg').forEach(svg => svg.style.display = 'none');
      } else {
        const svgs = document.querySelectorAll('svg');
        document.querySelector('.selection-container').style.display = 'flex';
        document.querySelector('.confirm-box').style.display = 'none';
        document.querySelector('.selection-box-banner').textContent = document.querySelector('.' + String(find_skill_type())).nextElementSibling.textContent;
        svgs.forEach(svg => svg.style.display = 'block');
        const btn = document.querySelector('.selection-btn-2');
        btn.disabled = true;
        return;
      }
    }

    function skill_protect(indexToKeep, type) {
      let new_skill;
      const skillPools = getSkillPools();
      document.querySelector('.card2').style.display = 'block';
      new_skill = type === 'premium' ? document.querySelector('.card2') : document.querySelector('.card1');
      const skillBoxes = new_skill.querySelectorAll('.skill-1, .skill-2, .skill-3');
      const originalBoxes = document.querySelector('.card1').querySelectorAll('.skill-1, .skill-2, .skill-3');
      const usedSkills = new Set();
      const skillCategories = {
        gold: { list: skillPools.gold, image: 'url(pics/gold.png)' },
        silver: { list: skillPools.silver, image: 'url(pics/silver.png)' },
        bronze: { list: skillPools.bronze, image: 'url(pics/bronze.png)' }
      };
      const keepIndex = indexToKeep - 1;
      const copiedText = originalBoxes[keepIndex].textContent;
      skillBoxes[keepIndex].textContent = copiedText;
      skillBoxes[keepIndex].style.backgroundImage = originalBoxes[keepIndex].style.backgroundImage;
      skillBoxes[keepIndex].style.backgroundSize = 'cover';
      usedSkills.add(copiedText.split('Lv')[0].trim());
      for (let i = 0; i < originalBoxes.length; i++) {
        if (i !== keepIndex) usedSkills.add(originalBoxes[i].textContent.split('Lv')[0].trim());
      }
      function getRandomSkillFrom(categoryList) {
        const available = categoryList.filter(skill => !usedSkills.has(skill));
        if (available.length === 0) return null;
        const skill = available[Math.floor(Math.random() * available.length)];
        usedSkills.add(skill);
        return skill;
      }
      function selectCategory() {
        const keys = ['gold', 'silver', 'bronze'];
        return keys[Math.floor(Math.random() * keys.length)];
      }
      for (let i = 0; i < skillBoxes.length; i++) {
        if (i === keepIndex) continue;
        const originalText = originalBoxes[i].textContent;
        const levelMatch = originalText.match(/Lv\.?\s*(\d)/i);
        const level = levelMatch ? parseInt(levelMatch[1]) : 1;
        let category = selectCategory();
        let skill = getRandomSkillFrom(skillCategories[category].list);
        if (!skill) {
          const fallbackKeys = Object.keys(skillCategories).filter(k => k !== category);
          while (fallbackKeys.length > 0 && !skill) {
            const randKey = fallbackKeys.splice(Math.floor(Math.random() * fallbackKeys.length), 1)[0];
            skill = getRandomSkillFrom(skillCategories[randKey].list);
            if (skill) { category = randKey; break; }
          }
        }
        skillBoxes[i].textContent = `${skill}  Lv. ${level}`;
        skillBoxes[i].style.backgroundImage = skillCategories[category].image;
        skillBoxes[i].style.backgroundSize = 'cover';
      }
      document.querySelector('.selection-container').style.display = 'none';
      document.querySelectorAll('svg').forEach(svg => svg.style.display = 'none');
      if (type === 'premium') {
        document.querySelector('.confirm-box').style.display = 'none';
        document.querySelector('.skill-changes-container').style.display = 'none';
        document.querySelector('.container').style.gap = '150px';
        document.querySelectorAll('.select-skill').forEach(skill => skill.style.display = 'flex');
        document.querySelector('.skill-box-right').style.display = 'block';
        document.querySelector('.card1').classList.add('hover-effect');
        document.querySelector('.card2').classList.add('hover-effect');
      }
    }

    function skill_select(indexToChange, type) {
      let new_skill;
      const skillPools = getSkillPools();
      document.querySelector('.card2').style.display = 'block';
      new_skill = type === 'premium' ? document.querySelector('.card2') : document.querySelector('.card1');
      const fromCard = document.querySelector('.card1');
      const fromSkills = fromCard.querySelectorAll('.skill-1, .skill-2, .skill-3');
      const skillBoxes = new_skill.querySelectorAll('.skill-1, .skill-2, .skill-3');
      const usedSkills = new Set();
      const skillCategories = {
        gold: { list: skillPools.gold, image: 'url(pics/gold.png)' },
        silver: { list: skillPools.silver, image: 'url(pics/silver.png)' },
        bronze: { list: skillPools.bronze, image: 'url(pics/bronze.png)' }
      };
      fromSkills.forEach(skillBox => usedSkills.add(skillBox.textContent.split('Lv')[0].trim()));
      function getRandomSkillFrom(categoryList) {
        const available = categoryList.filter(skill => !usedSkills.has(skill));
        if (available.length === 0) return null;
        const skill = available[Math.floor(Math.random() * available.length)];
        usedSkills.add(skill);
        return skill;
      }
      function selectCategory() {
        const keys = ['gold', 'silver', 'bronze'];
        return keys[Math.floor(Math.random() * keys.length)];
      }
      for (let i = 0; i < skillBoxes.length; i++) {
        const currentText = fromSkills[i].textContent;
        const levelMatch = currentText.match(/Lv\.?\s*(\d)/i);
        const level = levelMatch ? parseInt(levelMatch[1]) : 1;
        if (i === indexToChange - 1) {
          let category = selectCategory();
          let skill = getRandomSkillFrom(skillCategories[category].list);
          if (!skill) {
            const fallbackKeys = Object.keys(skillCategories).filter(k => k !== category);
            while (fallbackKeys.length > 0 && !skill) {
              const randKey = fallbackKeys.splice(Math.floor(Math.random() * fallbackKeys.length), 1)[0];
              skill = getRandomSkillFrom(skillCategories[randKey].list);
              if (skill) { category = randKey; break; }
            }
          }
          skillBoxes[i].textContent = `${skill}  Lv. ${level}`;
          skillBoxes[i].style.backgroundImage = skillCategories[category].image;
        } else {
          skillBoxes[i].textContent = currentText;
          skillBoxes[i].style.backgroundImage = fromSkills[i].style.backgroundImage;
        }
        skillBoxes[i].style.backgroundSize = 'cover';
      }
      document.querySelector('.selection-container').style.display = 'none';
      document.querySelectorAll('svg').forEach(svg => svg.style.display = 'none');
      if (type === 'premium') {
        document.querySelector('.confirm-box').style.display = 'none';
        document.querySelector('.skill-changes-container').style.display = 'none';
        document.querySelector('.container').style.gap = '150px';
        document.querySelectorAll('.select-skill').forEach(skill => skill.style.display = 'flex');
        document.querySelector('.skill-box-right').style.display = 'block';
        document.querySelector('.card1').classList.add('hover-effect');
        document.querySelector('.card2').classList.add('hover-effect');
      }
    }

    function get_selected() {
      for (let svg of document.querySelectorAll('svg')) {
        for (let path of svg.querySelectorAll('path')) {
          if (path.getAttribute('fill') === '#1ec71e') {
            const className = svg.parentElement.className;
            return parseInt(className[className.length - 1], 10);
          }
        }
      }
      return null;
    }

    function updateSkillBox() {
      const skills = document.querySelector('.card1');
      for (let i = 1; i <= 3; i++) {
        document.querySelector('.skill-box-original-' + i).textContent = skills.querySelector('.skill-' + i).textContent;
        document.querySelector('.selection-skill-box-original-' + i).textContent = skills.querySelector('.skill-' + i).textContent;
        document.querySelector('.skill-box-original-' + i).style.backgroundImage = skills.querySelector('.skill-' + i).style.backgroundImage;
        document.querySelector('.selection-skill-box-original-' + i).style.backgroundImage = skills.querySelector('.skill-' + i).style.backgroundImage;
      }
    }

    function toggleOverlay(element) {
      document.querySelectorAll('.skill-change .mask').forEach(mask => mask.style.display = 'none');
      const mask = element.querySelector('.mask');
      if (mask) mask.style.display = 'block';
      setUseButtonBackground(element);
    }

    function setUseButtonBackground(skillChangeElement) {
      const icon = skillChangeElement.querySelector('div[class$="-icon"]');
      const useButton = document.querySelector('.use-skill-changes');
      if (!icon || !useButton) return;
      useButton.style.backgroundImage = `url(${getImageNameFromClass(icon.className)})`;
    }

    function getImageNameFromClass(className) {
      if (className.includes('ultimate-skill-change-icon')) return 'pics/ultimate-skill-use.png';
      if (className.includes('legend-skill-change-icon')) return 'pics/legend-skill-use.png';
      if (className.includes('legend-skill-select-change-icon')) return 'pics/legend-select-use.png';
      if (className.includes('premium-skill-select-change-icon')) return 'pics/premium-select-use.png';
      if (className.includes('skill-select-change-icon')) return 'pics/skill-select-use.png';
      if (className.includes('premium-skill-protect-change-icon')) return 'pics/premium-protect-use.png';
      if (className.includes('skill-protect-change-icon')) return 'pics/skill-protect-use.png';
      return 'pics/skill-change-use.png';
    }

    let count1 = 0;
    let count2 = 0;

    function chooseSkill(element) {
      if (!element.classList.contains('hover-effect')) return;
      element.classList.add('choose-skill');
      if (element.classList.contains('card1')) {
        document.querySelector('.card2').classList.remove('choose-skill');
        count1++; count2 = 0;
      } else if (element.classList.contains('card2')) {
        document.querySelector('.card1').classList.remove('choose-skill');
        count2++; count1 = 0;
      }
      if (count1 === 2 || count2 === 2) {
        document.querySelector('.choose-skill-container').style.display = 'flex';
        if (count1 === 2) {
          document.querySelector('.choose-skill-banner').textContent = '保留技能';
          document.querySelector('.choose-skill-text').textContent = '您確定要保留原有的技能嗎?';
        } else {
          document.querySelector('.choose-skill-banner').textContent = '變更技能';
          document.querySelector('.choose-skill-text').textContent = '您確定要變更為新的技能嗎?';
        }
        count1 = 0; count2 = 0;
      } else {
        document.querySelector('.choose-skill-container').style.display = 'none';
      }
    }

    function closeChooseSkillContainer() {
      document.querySelector('.choose-skill-container').style.display = 'none';
      document.querySelector('.card1').classList.remove('choose-skill');
      document.querySelector('.card2').classList.remove('choose-skill');
      count1 = 0; count2 = 0;
    }

    function replaceSkill() {
      document.querySelector('.choose-skill-container').style.display = 'none';
      document.querySelector('.container').style.gap = '40px';
      document.querySelector('.skill-box-right').style.display = 'none';
      document.querySelector('.skill-changes-container').style.display = 'block';
      document.querySelector('.select-skill').style.display = 'none';
      if (document.querySelector('.card2').classList.contains('choose-skill')) {
        for (let i = 1; i <= 3; i++) {
          const from = document.querySelector('.card2 .skill-' + i);
          const to = document.querySelector('.card1 .skill-' + i);
          to.textContent = from.textContent;
          to.style.backgroundImage = from.style.backgroundImage;
        }
      }
      document.querySelector('.card1').classList.remove('hover-effect');
      document.querySelector('.card2').classList.remove('hover-effect');
      document.querySelector('.card1').classList.remove('choose-skill');
      document.querySelector('.card2').classList.remove('choose-skill');
      updateSkillBox();
      document.querySelector('.switch').style.display = 'flex';
    }

    function ChangeSkill() {
      const iconClass = find_skill_type();
      switch (iconClass) {
        case 'skill-change-icon': ChangeSkills_basic('normal'); break;
        case 'ultimate-skill-change-icon': ChangeSkills_basic('ultimate'); break;
        case 'legend-skill-change-icon': ChangeSkills_basic('legend'); break;
        case 'legend-skill-select-change-icon': legend_skill_select(); break;
        case 'skill-select-change-icon': skill_select(get_selected(), 'normal'); document.querySelector('.switch').style.display = 'flex'; break;
        case 'premium-skill-select-change-icon': skill_select(get_selected(), 'premium'); break;
        case 'skill-protect-change-icon': skill_protect(get_selected(), 'normal'); document.querySelector('.switch').style.display = 'flex'; break;
        case 'premium-skill-protect-change-icon': skill_protect(get_selected(), 'premium'); break;
        default: break;
      }
      reset_svg();
    }

    function find_skill_type() {
      for (const change of document.querySelectorAll('.skill-change')) {
        const mask = change.querySelector('.mask');
        if (mask && window.getComputedStyle(mask).display === 'block') {
          return change.querySelector('div').className;
        }
      }
    }

    function select_svg(element) {
      const btn = document.querySelector('.selection-btn-2');
      btn.disabled = false;
      document.querySelectorAll('svg path.p1, svg path.p2, svg path.p3').forEach(path => path.setAttribute('fill', '#051350'));
      const targetPath = element.querySelector('.p1, .p2, .p3');
      if (targetPath) targetPath.setAttribute('fill', '#1ec71e');
    }

    /* ===== DOMContentLoaded init ===== */
    document.addEventListener('DOMContentLoaded', function() {
      loadSidebar();
      updateSkillBox();
      initializeSkillBoxes();

      // 預設選中的 skill-change
      const defaultSelected = document.querySelector('.skill-change .mask[style*="block"]');
      if (defaultSelected) {
        const skillChange = defaultSelected.closest('.skill-change');
        if (skillChange) setUseButtonBackground(skillChange);
      }

      // drag scroll
      const skillChanges = document.querySelector('.skill-changes');
      let isDragging = false, startY, startScrollTop;
      skillChanges.addEventListener('mousedown', e => { isDragging = true; startY = e.clientY; startScrollTop = skillChanges.scrollTop; skillChanges.style.cursor = 'grabbing'; });
      skillChanges.addEventListener('mousemove', e => { if (!isDragging) return; skillChanges.scrollTop = startScrollTop - (e.clientY - startY); });
      skillChanges.addEventListener('mouseup', () => { isDragging = false; skillChanges.style.cursor = 'auto'; });
      skillChanges.addEventListener('mouseleave', () => { isDragging = false; skillChanges.style.cursor = 'auto'; });
    });

    // 頁面載入後設定 label 顏色
    window.addEventListener('load', function() {
      document.getElementById('labelText').style.color = 'crimson';
    });
  </script>
</body>
</html>