<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>五拍計算機</title>
    <link rel="stylesheet" href="navigation.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap');
        
        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        
        body {
            font-family: 'Noto Sans TC', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .page-container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            text-align: center;
            padding: 30px;
            margin-bottom: 0;
        }
        
        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin: 0;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .content-wrapper {
            padding: 40px;
        }
        
        .calculator-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(79, 172, 254, 0.2);
        }
        
        .section-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #4facfe;
            margin-bottom: 20px;
            text-align: center;
            position: relative;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            border-radius: 2px;
        }
        
        .stats-table {
            margin: 0 auto 30px;
            border-collapse: collapse;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            background: white;
            width: 100%;
            max-width: 100%;
        }
        
        .stats-table-mobile {
            display: none;
            table-layout: fixed;
            width: 100%;
        }
        
        .stats-table-mobile th,
        .stats-table-mobile td {
            padding: 10px 6px;
            font-size: 0.85rem;
            text-align: center;
        }
        
        /* 第一列（屬性名稱）固定寬度 */
        .stats-table-mobile th:first-child,
        .stats-table-mobile td:first-child {
            width: 60px;
            background: linear-gradient(135deg, #f8f9ff 0%, #e6f3ff 100%);
            font-weight: 700;
            color: #4facfe;
        }
        
        /* 第二、三、四列（上升量、基礎值、強化量）平均分配剩餘寬度 */
        .stats-table-mobile th:nth-child(2),
        .stats-table-mobile th:nth-child(3),
        .stats-table-mobile th:nth-child(4),
        .stats-table-mobile td:nth-child(2),
        .stats-table-mobile td:nth-child(3),
        .stats-table-mobile td:nth-child(4) {
            width: calc((100% - 60px) / 3);
        }
        
        .stats-table-mobile input[type="number"] {
            max-width: 100%;
            width: 100%;
            box-sizing: border-box;
        }
        
        .stats-table-mobile .dev-box {
            width: 100%;
            box-sizing: border-box;
        }
        
        .stats-table th {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 12px 8px;
            font-weight: 600;
            text-align: center;
            font-size: 0.85rem;
            white-space: nowrap;
        }
        
        .stats-table td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid #f0f0f0;
            background: #fafafa;
            font-weight: 500;
        }
        
        .stats-table tr:last-child td {
            border-bottom: none;
        }
        
        .stats-table td:first-child {
            background: linear-gradient(135deg, #f8f9ff 0%, #e6f3ff 100%);
            font-weight: 600;
            color: #4facfe;
            font-size: 0.85rem;
            white-space: nowrap;
        }
        
        input[type="number"] {
            width: 100%;
            max-width: 70px;
            padding: 8px 4px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            text-align: center;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            background: white;
            box-sizing: border-box;
        }
        
        input[type="number"]:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
            transform: translateY(-1px);
        }
        
        input[type="number"]:hover {
            border-color: #4facfe;
        }
        
        .dev-box {
            width: 70px;
            height: 36px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.3);
        }
        
        .controls-section {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .controls-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .control-group {
            background: linear-gradient(135deg, #f8f9ff 0%, #e6f3ff 100%);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(79, 172, 254, 0.2);
        }
        
        .control-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #4facfe;
            font-size: 1rem;
        }
        
        select {
            width: 100%;
            padding: 10px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        select:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }
        
        select:hover {
            border-color: #4facfe;
        }
        
        .calculate-btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 8px 20px rgba(79, 172, 254, 0.3);
            transition: all 0.3s ease;
            display: block;
            margin: 30px auto 0;
            min-width: 200px;
        }
        
        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 30px rgba(79, 172, 254, 0.4);
        }
        
        .calculate-btn:active {
            transform: translateY(0);
        }
        
        .data-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(79, 172, 254, 0.2);
        }
        
        .results-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .result-card {
            background: linear-gradient(135deg, #f8f9ff 0%, #e6f3ff 100%);
            padding: 25px;
            border-radius: 12px;
            border: 2px solid rgba(79, 172, 254, 0.2);
            text-align: center;
        }
        
        .result-card h3 {
            color: #4facfe;
            font-size: 1.1rem;
            font-weight: 600;
            margin: 0 0 15px 0;
        }
        
        .result-value {
            font-size: 2rem;
            font-weight: 700;
            color: #667eea;
            margin: 0;
        }
        
        /* 等級對應參考表樣式 */
        .data-table {
            width: 70%;
            border-collapse: collapse;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            background: white;
            margin: 20px auto 0;
        }
        
        .data-table thead {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }
        
        .data-table th {
            padding: 15px;
            font-weight: 600;
            text-align: center;
            font-size: 1rem;
        }
        
        .data-table td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid #f0f0f0;
            font-weight: 500;
            background: #fafafa;
        }
        
        .data-table tbody tr:last-child td {
            border-bottom: none;
        }
        
        .data-table tbody tr:hover {
            background: linear-gradient(135deg, #f8f9ff 0%, #e6f3ff 100%);
            transition: background 0.3s ease;
        }
        
        /* 等級範圍列樣式 */
        .data-table td:first-child {
            background: linear-gradient(135deg, #f8f9ff 0%, #e6f3ff 100%);
            font-weight: 600;
            color: #4facfe;
        }
        
        /* 為不同等級組添加微妙的顏色區分 */
        .data-table .group-1,
        .data-table .group-2,
        .data-table .group-3 {
            background: #fafcff;
        }
        
        .data-table .group-4,
        .data-table .group-5,
        .data-table .group-6 {
            background: #f8fbff;
        }
        
        .data-table .group-7,
        .data-table .group-8,
        .data-table .group-9 {
            background: #f6faff;
        }
        
        .data-table .group-10,
        .data-table .group-11,
        .data-table .group-12 {
            background: #f4f9ff;
        }
        
        .data-table .group-13,
        .data-table .group-14,
        .data-table .group-15 {
            background: #f2f8ff;
        }
        
        /* 高亮當前等級的樣式 */
        .data-table tbody tr.highlighted {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%) !important;
            font-weight: 700;
            transform: scale(1.02);
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
            transition: all 0.3s ease;
        }
        
        .data-table tbody tr.highlighted td {
            background: transparent !important;
            color: #2c3e50;
        }
        
        .data-table tbody tr.highlighted td:first-child {
            color: #2c3e50;
            font-weight: 700;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .page-container {
                border-radius: 15px;
            }
            
            .header {
                padding: 25px 20px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .content-wrapper {
                padding: 20px;
            }
            
            .calculator-section {
                padding: 20px;
                margin-bottom: 20px;
            }
            
            .section-title {
                font-size: 1.1rem;
            }
            
            .controls-row {
                grid-template-columns: 1fr;
            }
            
            .control-group {
                padding: 15px;
            }
            
            .stats-table {
                font-size: 0.85rem;
            }
            
            .stats-table th {
                padding: 10px 4px;
                font-size: 0.75rem;
            }
            
            .stats-table td {
                padding: 8px 4px;
            }
            
            .stats-table td:first-child {
                font-size: 0.7rem;
                padding: 8px 6px;
            }
            
            input[type="number"] {
                max-width: 50px;
                padding: 6px 2px;
                font-size: 13px;
            }
            
            .dev-box {
                width: 50px;
                height: 32px;
                font-size: 13px;
            }
            
            .calculate-btn {
                padding: 12px 30px;
                font-size: 1rem;
                min-width: 150px;
            }
            
            .results-section {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .result-card {
                padding: 20px;
            }
            
            .result-value {
                font-size: 1.5rem;
            }
            
            .data-section {
                padding: 20px 15px;
            }
            
            .data-table {
                width: 100%;
            }
            
            .data-table th,
            .data-table td {
                padding: 10px 8px;
                font-size: 0.9rem;
            }
            
            .data-table th {
                font-size: 0.95rem;
            }
        }
        
        @media (max-width: 480px) {
            /* 隱藏桌面版表格，顯示手機版表格 */
            .stats-table-desktop {
                display: none !important;
            }
            
            .stats-table-mobile {
                display: table !important;
            }
            
            body {
                padding: 5px;
            }
            
            .page-container {
                border-radius: 15px;
            }
            
            .header {
                padding: 20px 15px;
            }
            
            .header h1 {
                font-size: 1.5rem;
            }
            
            .content-wrapper {
                padding: 10px;
            }
            
            .calculator-section {
                padding: 15px 10px;
                margin-bottom: 15px;
            }
            
            .section-title {
                font-size: 1rem;
                margin-bottom: 15px;
            }
            
            input[type="number"] {
                max-width: 45px;
                padding: 5px 2px;
                font-size: 12px;
            }
            
            .dev-box {
                width: 45px;
                height: 28px;
                font-size: 12px;
            }
            
            .control-group {
                padding: 12px;
            }
            
            .control-group label {
                font-size: 0.9rem;
            }
            
            select {
                padding: 8px 12px;
                font-size: 13px;
            }
            
            .calculate-btn {
                padding: 10px 25px;
                font-size: 0.95rem;
                min-width: 130px;
            }
            
            .result-card {
                padding: 15px;
            }
            
            .result-card h3 {
                font-size: 0.95rem;
            }
            
            .result-value {
                font-size: 1.3rem;
            }
            
            .data-table {
                width: 100%;
            }
            
            .data-table th,
            .data-table td {
                padding: 8px 6px;
                font-size: 0.85rem;
            }
            
            .data-table th {
                font-size: 0.9rem;
                padding: 12px 8px;
            }
            
            .data-table td:first-child {
                font-size: 0.8rem;
            }
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .calculator-section,
        .data-section {
            animation: fadeInUp 0.6s ease-out;
        }
        
        .data-section {
            animation-delay: 0.2s;
        }
    </style>
</head>
<body>
    <!-- 主內容 -->
    <div class="main-content">
        <div class="page-container">
            <div class="header">
                <h1>五拍計算機</h1>
            </div>
            
            <div class="content-wrapper">
                <div class="calculator-section">
                    <div class="section-title">球員屬性設定</div>
                    
                    <!-- 桌面版表格 -->
                    <table class="stats-table stats-table-desktop">
                        <thead>
                            <tr>
                                <th></th>
                                <th>接觸</th>
                                <th>力量</th>
                                <th>選球</th>
                                <th>速度</th>
                                <th>守備</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>上升量</td>
                                <td data-label="接觸"><input type="number" id="GI_contact" min="0" max="30"></td>
                                <td data-label="力量"><input type="number" id="GI_power" min="0" max="30"></td>
                                <td data-label="選球"><input type="number" id="GI_selection" min="0" max="30"></td>
                                <td data-label="速度"><input type="number" id="GI_speed" min="0" max="30"></td>
                                <td data-label="守備"><input type="number" id="GI_defense" min="0" max="30"></td>
                            </tr>
                            <tr>
                                <td>基礎值</td>
                                <td data-label="接觸"><input type="number" id="base_contact"></td>
                                <td data-label="力量"><input type="number" id="base_power"></td>
                                <td data-label="選球"><input type="number" id="base_selection"></td>
                                <td data-label="速度"><input type="number" id="base_speed"></td>
                                <td data-label="守備"><input type="number" id="base_defense"></td>
                            </tr>
                            <tr>
                                <td>強化量</td>
                                <td data-label="接觸"><span class="dev-box" id="dev_contact">0</span></td>
                                <td data-label="力量"><span class="dev-box" id="dev_power">0</span></td>
                                <td data-label="選球"><span class="dev-box" id="dev_selection">0</span></td>
                                <td data-label="速度"><span class="dev-box" id="dev_speed">0</span></td>
                                <td data-label="守備"><span class="dev-box" id="dev_defense">0</span></td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <!-- 手機版表格（轉置） -->
                    <table class="stats-table stats-table-mobile">
                        <thead>
                            <tr>
                                <th></th>
                                <th>上升量</th>
                                <th>基礎值</th>
                                <th>強化量</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>接觸</td>
                                <td><input type="number" id="mobile_GI_contact" class="mobile-gi-contact" min="0" max="30"></td>
                                <td><input type="number" id="mobile_base_contact" class="mobile-base-contact"></td>
                                <td><span class="dev-box" id="mobile_dev_contact">0</span></td>
                            </tr>
                            <tr>
                                <td>力量</td>
                                <td><input type="number" id="mobile_GI_power" class="mobile-gi-power" min="0" max="30"></td>
                                <td><input type="number" id="mobile_base_power" class="mobile-base-power"></td>
                                <td><span class="dev-box" id="mobile_dev_power">0</span></td>
                            </tr>
                            <tr>
                                <td>選球</td>
                                <td><input type="number" id="mobile_GI_selection" class="mobile-gi-selection" min="0" max="30"></td>
                                <td><input type="number" id="mobile_base_selection" class="mobile-base-selection"></td>
                                <td><span class="dev-box" id="mobile_dev_selection">0</span></td>
                            </tr>
                            <tr>
                                <td>速度</td>
                                <td><input type="number" id="mobile_GI_speed" class="mobile-gi-speed" min="0" max="30"></td>
                                <td><input type="number" id="mobile_base_speed" class="mobile-base-speed"></td>
                                <td><span class="dev-box" id="mobile_dev_speed">0</span></td>
                            </tr>
                            <tr>
                                <td>守備</td>
                                <td><input type="number" id="mobile_GI_defense" class="mobile-gi-defense" min="0" max="30"></td>
                                <td><input type="number" id="mobile_base_defense" class="mobile-base-defense"></td>
                                <td><span class="dev-box" id="mobile_dev_defense">0</span></td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div class="controls-section">
                        <!-- 第一列：球員類型和目標等級 -->
                        <div class="controls-row">
                            <div class="control-group">
                                <label for="player_type">球員類型</label>
                                <select id="player_type" onchange="type_of_player()">
                                    <option value="type">請選擇類型</option>
                                    <option value="supreme">卓越</option>
                                    <option value="normal">非卓越</option>
                                </select>
                            </div>
                            
                            <div class="control-group">
                                <label for="player_level">目標等級</label>
                                <select id="player_level" onchange="select_level()">
                                    <option value="max">最大等級</option>
                                    <option value=83>83</option>
                                    <option value=85>85</option>
                                    <option value=88>88</option>
                                    <option value=90>90</option>
                                    <option value=93>93</option>
                                    <option value=95>95</option>
                                    <option value=98>98</option>
                                    <option value=100>100</option>
                                    <option value=103>103</option>
                                    <option value=105>105</option>
                                    <option value=108>108</option>
                                    <option value=110>110</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- 第二列：特訓1、2、3 -->
                        <div class="controls-row">
                            <div class="control-group">
                                <label for="training1">特訓1</label>
                                <select id="training1" onchange="updateTrainingOptions()">
                                    <option value="0">請選擇屬性</option>
                                    <option value="contact">接觸</option>
                                    <option value="power">力量</option>
                                    <option value="selection">選球</option>
                                    <option value="speed">速度</option>
                                    <option value="defense">守備</option>
                                </select>
                            </div>
                            
                            <div class="control-group">
                                <label for="training2">特訓2</label>
                                <select id="training2" onchange="updateTrainingOptions()">
                                    <option value="0">請選擇屬性</option>
                                    <option value="contact">接觸</option>
                                    <option value="power">力量</option>
                                    <option value="selection">選球</option>
                                    <option value="speed">速度</option>
                                    <option value="defense">守備</option>
                                </select>
                            </div>
                            
                            <div class="control-group">
                                <label for="training3">特訓3</label>
                                <select id="training3">
                                    <option value="0">請選擇屬性</option>
                                    <option value="contact">接觸</option>
                                    <option value="power">力量</option>
                                    <option value="selection">選球</option>
                                    <option value="speed">速度</option>
                                    <option value="defense">守備</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <button class="calculate-btn" onclick="calculate()">計算</button>
                </div>
                
                <div class="data-section">
                    <div class="section-title">計算結果</div>
                    <div class="results-section">
                        <div class="result-card">
                            <h3>最大可達等級</h3>
                            <p class="result-value" id="result">-</p>
                        </div>
                        <div class="result-card">
                            <h3>剩餘自由點數</h3>
                            <p class="result-value" id="freepoint">-</p>
                        </div>
                    </div>
                </div>
                
                <div class="data-section">
                    <div class="section-title">等級對應參考表</div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>等級範圍</th>
                                <th>LV7</th>
                                <th>LV8</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="group-1" data-level-range="80-82"><td>80-82</td><td>7</td><td>8</td></tr>
                            <tr class="group-2" data-level-range="83-84"><td>83-84</td><td>8</td><td>9</td></tr>
                            <tr class="group-3" data-level-range="85"><td>85</td><td>8</td><td>10</td></tr>
                            <tr class="group-4" data-level-range="86-87"><td>86-87</td><td>9</td><td>10</td></tr>
                            <tr class="group-5" data-level-range="88"><td>88</td><td>9</td><td>11</td></tr>
                            <tr class="group-6" data-level-range="89"><td>89</td><td>10</td><td>11</td></tr>
                            <tr class="group-7" data-level-range="90-92"><td>90-92</td><td>10</td><td>12</td></tr>
                            <tr class="group-8" data-level-range="93-94"><td>93-94</td><td>11</td><td>13</td></tr>
                            <tr class="group-9" data-level-range="95-97"><td>95-97</td><td>12</td><td>14</td></tr>
                            <tr class="group-10" data-level-range="98-99"><td>98-99</td><td>13</td><td>15</td></tr>
                            <tr class="group-11" data-level-range="100-102"><td>100-102</td><td>14</td><td>16</td></tr>
                            <tr class="group-12" data-level-range="103-104"><td>103-104</td><td>15</td><td>17</td></tr>
                            <tr class="group-13" data-level-range="105-107"><td>105-107</td><td>16</td><td>18</td></tr>
                            <tr class="group-14" data-level-range="108-109"><td>108-109</td><td>17</td><td>19</td></tr>
                            <tr class="group-15" data-level-range="110"><td>110</td><td>18</td><td>20</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 高亮顯示等級對應表中的對應列
        function highlightLevelRow(level) {
            // 移除所有高亮
            const allRows = document.querySelectorAll('.data-table tbody tr');
            allRows.forEach(row => row.classList.remove('highlighted'));
            
            // 如果等級無效,不高亮任何行
            if (!level || level === "無法達成此階級") {
                return;
            }
            
            // 找到對應的行並高亮
            allRows.forEach(row => {
                const range = row.getAttribute('data-level-range');
                if (range) {
                    if (range.includes('-')) {
                        // 範圍格式 "80-82"
                        const [min, max] = range.split('-').map(Number);
                        if (level >= min && level <= max) {
                            row.classList.add('highlighted');
                        }
                    } else {
                        // 單一值格式 "85"
                        if (level == parseInt(range)) {
                            row.classList.add('highlighted');
                        }
                    }
                }
            });
        }
        
        function calculate() {
            selected_level = select_level();

            let grade_array;
            let max_level;
            let free_point;
            let dev;

            if (selected_level == "max"){
                grade_array = max_grade()
                max_level = grade_array[5]
                free_point = grade_array[6]
                dev = grade_array.slice(0,5)
            }
            else {
                grade_array = level_validation(selected_level)
                if (grade_array == false){
                    grade_array = [0,0,0,0,0,"無法達成此階級",0]
                }
                max_level = grade_array[5]
                free_point = grade_array[6]
                dev = grade_array.slice(0,5)
            }
            
            let stats = ['contact', 'power', 'selection', 'speed', 'defense']

            if (document.getElementById("player_type").value == "type"){
                alert("請選擇球員類型");
            }
            else if (document.getElementById("training1").value == "0" || document.getElementById("training2").value == "0" || document.getElementById("training3").value == "0"){
                alert("請選擇特訓");
            }
            else{
                stats.forEach((stat, index) => {
                    // 桌面版強化量顯示
                    let span = document.getElementById(`dev_${stat}`);
                    if (span) {
                        span.textContent = dev[index];
                    }
                    // 手機版強化量顯示
                    let mobileSpan = document.getElementById(`mobile_dev_${stat}`);
                    if (mobileSpan) {
                        mobileSpan.textContent = dev[index];
                    }
                });
                
                level = document.getElementById('result');
                point = document.getElementById('freepoint');
                level.textContent = max_level;
                point.textContent = free_point;
                
                // 高亮顯示等級對應表中的對應行
                highlightLevelRow(max_level);
            }
        }

        function max_grade(){
            const grade = [83,85,88,90,93,95,98,100,103,105,108,110]
            let res = [0,0,0,0,0,0,0]
            for (let i = 0;i < grade.length;i++){
                let cur_res = level_validation(grade[i])
                if (cur_res == false){
                    break
                }
                else{
                    res = cur_res
                }
            }
            return res
        }

        function level_validation(level) {
            console.log(level)
            let GI_values = getGIValues();
            let Base_values = getBaseValues();
            let free_point = type_of_player()

            let dev = [0,0,0,0,0]
            for (let i = 0; i < 5; i++) {
                let dif = Math.max((level - (GI_values[i] + Base_values[i])),0)
                dev[i] = dif
                free_point -= dif
                if (free_point < 0){
                    return false
                }
            }
            
            let training1 = document.getElementById('training1').value;
            let training2 = document.getElementById('training2').value;
            let training3 = document.getElementById('training3').value;
            let training4 = -1
            let training5 = -1
            let stats = ['contact', 'power', 'selection', 'speed', 'defense'];
            for (let i = 0; i < 5;i++){
                switch (stats[i]){
                    case training1:
                        training1 = i;
                        break
                    case training2:
                        training2 = i
                        break
                    case training3:
                        training3 = i
                        break
                    default:
                        if (training4 > training5){
                            training5 = i
                        }
                        else{
                            training4 = i
                        }
                        break
                }
            }
            let train_array = [training1,training2,training3]
            let max_dev_index = (dev[training4] > dev[training5]) ? training4 : training5;
            for (let i = 0;i < 3; i++){
                let dev_diff = Math.max(dev[max_dev_index]- dev[train_array[i]],0)
                dev[train_array[i]] +=  dev_diff
                free_point -= dev_diff
            }
            if (free_point < 0){
                return false
            }
            
            for (let i = 1;i >= 0; i--){
                let train_diff = dev[train_array[i+1]] > dev[train_array[i]] ? dev[train_array[i+1]] - dev[train_array[i]]:0
                dev[train_array[i]] += train_diff
                free_point -= train_diff

                if ((Base_values[train_array[i]] < Base_values[train_array[i+1]]) && dev[train_array[i+1]] == dev[train_array[i]]){
                    dev[train_array[i]]++
                    free_point--
                }
                if (free_point < 0){
                    return false
                }
            }
            
            return dev.concat([level,free_point])
        }

        function type_of_player() {
            let dev; 
            switch (document.getElementById("player_type").value) {
                case "type":
                    dev = 0;
                    break;
                case "supreme":
                    dev = 87;
                    break;
                case "normal":
                    dev = 57;
                    break;
                default:
                    dev = 0;
                    break;
            }
            return dev
        }

        function select_level() {
            if (document.getElementById("player_level").value == "max"){
                return "max"
            } 
            else{
                return Number(document.getElementById("player_level").value)
            }
        }

        // 修正：檢測螢幕寬度並返回對應的輸入欄位
        function getGIValues() {
            const isMobile = window.innerWidth <= 480;
            const prefix = isMobile ? 'mobile_GI_' : 'GI_';
            
            return ['contact', 'power', 'selection', 'speed', 'defense'].map(stat => {
                let element = document.getElementById(`${prefix}${stat}`);
                let GI = parseFloat(element?.value) || 0;
                return GI;
            });
        }

        function getBaseValues() {
            const isMobile = window.innerWidth <= 480;
            const prefix = isMobile ? 'mobile_base_' : 'base_';
            
            return ['contact', 'power', 'selection', 'speed', 'defense'].map(stat => {
                let element = document.getElementById(`${prefix}${stat}`);
                let base = parseFloat(element?.value) || 0;
                return base;
            });
        }

        function updateTrainingOptions() {
            let allOptions = ['contact', 'power', 'selection', 'speed', 'defense'];
            let selected1 = document.getElementById('training1').value;
            let selected2 = document.getElementById('training2').value;
            
            let training2 = document.getElementById('training2');
            let training3 = document.getElementById('training3');
            
            let availableOptions2 = allOptions.filter(opt => opt !== selected1);
            let availableOptions3 = availableOptions2.filter(opt => opt !== selected2);
            
            training2.innerHTML = '<option value="0">請選擇屬性</option>' + availableOptions2.map(opt => `<option value="${opt}" ${opt === selected2 ? 'selected' : ''}>${translateOption(opt)}</option>`).join('');
            training3.innerHTML = '<option value="0">請選擇屬性</option>' + availableOptions3.map(opt => `<option value="${opt}">${translateOption(opt)}</option>`).join('');
        }

        function translateOption(option) {
            let translations = {
                'contact': '接觸',
                'power': '力量',
                'selection': '選球',
                'speed': '速度',
                'defense': '守備'
            };
            return translations[option] || option;
        }
        
        // 同步桌面版和手機版表格數據
        function syncInputs() {
            const stats = ['contact', 'power', 'selection', 'speed', 'defense'];
            
            stats.forEach(stat => {
                // 同步 GI 輸入
                const desktop_GI = document.getElementById(`GI_${stat}`);
                const mobile_GI = document.getElementById(`mobile_GI_${stat}`);
                
                if (desktop_GI && mobile_GI) {
                    desktop_GI.addEventListener('input', (e) => {
                        mobile_GI.value = e.target.value;
                    });
                    mobile_GI.addEventListener('input', (e) => {
                        desktop_GI.value = e.target.value;
                    });
                }
                
                // 同步 base 輸入
                const desktop_base = document.getElementById(`base_${stat}`);
                const mobile_base = document.getElementById(`mobile_base_${stat}`);
                
                if (desktop_base && mobile_base) {
                    desktop_base.addEventListener('input', (e) => {
                        mobile_base.value = e.target.value;
                    });
                    mobile_base.addEventListener('input', (e) => {
                        desktop_base.value = e.target.value;
                    });
                }
            });
        }
        
        // 頁面載入時執行同步
        window.addEventListener('DOMContentLoaded', syncInputs);
    </script>
    <script src="navigation.js"></script>
</body>
</html>