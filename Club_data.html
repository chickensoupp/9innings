<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>棒球遊戲球員管理系統</title>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft JhengHei', sans-serif;
            background: linear-gradient(135deg, #e0f2fe 0%, #dcfce7 100%);
            min-height: 100vh;
            padding: 1.5rem;
        }
        .container { max-width: 1400px; margin: 0 auto; }
        .card {
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }
        .title {
            font-size: 1.875rem;
            font-weight: bold;
            color: #1f2937;
        }
        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
        }
        .btn-primary { background: #2563eb; color: white; }
        .btn-primary:hover { background: #1d4ed8; }
        .btn-success { background: #16a34a; color: white; }
        .btn-success:hover { background: #15803d; }
        .btn-purple { background: #9333ea; color: white; }
        .btn-purple:hover { background: #7e22ce; }
        .btn-secondary { background: #e5e7eb; color: #374151; }
        .btn-secondary:hover { background: #d1d5db; }
        .btn-light-blue { background: #dbeafe; color: #1e40af; }
        .btn-light-blue:hover { background: #bfdbfe; }
        .btn-light-green { background: #dcfce7; color: #166534; }
        .btn-light-green:hover { background: #bbf7d0; }
        .btn-sm { padding: 0.375rem; }
        .tabs {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            align-items: center;
        }
        .tab {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            font-size: 0.875rem;
        }
        .tab.active { background: #2563eb; color: white; }
        .tab.inactive { background: #e5e7eb; color: #374151; }
        .tab.inactive:hover { background: #d1d5db; }
        .tab.player.active { background: #16a34a; }
        .label {
            font-weight: 600;
            color: #374151;
            margin-right: 0.5rem;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
        }
        th, td {
            border: 1px solid #d1d5db;
            padding: 0.75rem;
            text-align: left;
        }
        th {
            background: #f3f4f6;
            font-weight: 600;
        }
        tr:hover {
            background: #f9fafb;
        }
        input, select {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            font-size: 0.875rem;
        }
        input:focus, select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        input:disabled {
            background: #f3f4f6;
            cursor: not-allowed;
        }
        .section-title {
            font-size: 1.25rem;
            font-weight: bold;
            color: #1e40af;
            border-bottom: 2px solid #93c5fd;
            padding-bottom: 0.5rem;
            margin-bottom: 1rem;
        }
        .modal {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 50;
            padding: 1rem;
        }
        .modal-content {
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 20px 25px rgba(0,0,0,0.15);
            max-width: 1000px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            padding: 1.5rem;
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        .modal-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #1f2937;
        }
        .close-btn {
            background: none;
            border: none;
            font-size: 2rem;
            color: #6b7280;
            cursor: pointer;
            line-height: 1;
        }
        .close-btn:hover { color: #374151; }
        .settings-section { margin-bottom: 1.5rem; }
        .settings-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1e40af;
            margin-bottom: 0.75rem;
        }
        .input-group {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        .skill-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }
        .skill-card {
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1rem;
        }
        .skill-card-title {
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.5rem;
        }
        .skill-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #f9fafb;
            padding: 0.5rem;
            border-radius: 0.375rem;
            margin-bottom: 0.25rem;
        }
        .delete-btn {
            background: none;
            border: none;
            color: #dc2626;
            cursor: pointer;
            font-size: 0.875rem;
        }
        .delete-btn:hover { color: #991b1b; }
        .overflow-x { overflow-x: auto; }
        .flex-gap { display: flex; gap: 0.5rem; align-items: center; }
        input[type="text"].inline-edit {
            background: transparent;
            border: none;
            outline: none;
            width: 5rem;
            padding: 0;
        }
        input[type="text"].inline-edit:focus {
            box-shadow: none;
        }
        .edit-input {
            padding: 0.5rem 0.75rem;
            border: 2px solid #3b82f6;
            border-radius: 0.5rem;
        }
        .section-row {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        const RosterSection = ({ title, category, count, isPitcher, roster, updateRosterItem, skillOptions, coachOptions }) => {
            return (
                <div style={{ marginBottom: '2rem' }}>
                    <h3 className="section-title">
                        {title} ({count}人)
                    </h3>
                    <div className="overflow-x">
                        <table>
                            <thead>
                                <tr>
                                    <th style={{ width: '60px' }}>位置</th>
                                    <th style={{ width: '180px' }}>球員姓名</th>
                                    <th>技能1</th>
                                    <th>技能2</th>
                                    <th>技能3</th>
                                    <th>教練1</th>
                                    <th style={{ width: '150px' }}>教練2技能</th>
                                    <th style={{ width: '80px' }}>等級</th>
                                    <th style={{ width: '120px' }}>備註</th>
                                </tr>
                            </thead>
                            <tbody>
                                {roster.map((item, idx) => (
                                    <tr key={`${category}-${idx}`}>
                                        <td style={{ textAlign: 'center', fontWeight: 600 }}>
                                            {title === '先發投手' ? `先發${idx + 1}` :
                                             title === '後援投手' ? `後援${idx + 1}` :
                                             `${idx + 1}棒`}
                                        </td>
                                        <td>
                                            <input
                                                type="text"
                                                value={item.name}
                                                onChange={(e) => updateRosterItem(category, idx, 'name', e.target.value)}
                                                placeholder="輸入球員姓名"
                                            />
                                        </td>
                                        {['skill1', 'skill2', 'skill3'].map((skill, skillIdx) => (
                                            <td key={skill}>
                                                <select
                                                    value={item[skill]}
                                                    onChange={(e) => updateRosterItem(category, idx, skill, e.target.value)}
                                                >
                                                    <option value="">選擇技能</option>
                                                    {isPitcher && (
                                                        <>
                                                            {skillIdx === 0 && (
                                                                <optgroup label="投手黑技">
                                                                    {skillOptions.pitcherType1.map((option) => (
                                                                        <option key={option} value={option}>{option}</option>
                                                                    ))}
                                                                </optgroup>
                                                            )}
                                                            <optgroup label="投手金技">
                                                                {skillOptions.pitcherType2.map((option) => (
                                                                    <option key={option} value={option}>{option}</option>
                                                                ))}
                                                            </optgroup>
                                                        </>
                                                    )}
                                                    {!isPitcher && (
                                                        <>
                                                            {skillIdx === 0 && (
                                                                <optgroup label="打者黑技">
                                                                    {skillOptions.batterType1.map((option) => (
                                                                        <option key={option} value={option}>{option}</option>
                                                                    ))}
                                                                </optgroup>
                                                            )}
                                                            <optgroup label="打者金技">
                                                                {skillOptions.batterType2.map((option) => (
                                                                    <option key={option} value={option}>{option}</option>
                                                                ))}
                                                            </optgroup>
                                                        </>
                                                    )}
                                                </select>
                                            </td>
                                        ))}
                                        <td>
                                            <select
                                                value={item.coach1}
                                                onChange={(e) => updateRosterItem(category, idx, 'coach1', e.target.value)}
                                            >
                                                <option value="">白教</option>
                                                {isPitcher && coachOptions.pitcherCoach1.map((option) => (
                                                    <option key={option} value={option}>{option}</option>
                                                ))}
                                                {!isPitcher && coachOptions.batterCoach1.map((option) => (
                                                    <option key={option} value={option}>{option}</option>
                                                ))}
                                            </select>
                                        </td>
                                        <td>
                                            <select
                                                value={item.coach2Skill}
                                                onChange={(e) => updateRosterItem(category, idx, 'coach2Skill', e.target.value)}
                                            >
                                                <option value="">白技</option>
                                                {isPitcher && skillOptions.pitcherType1.map((option) => (
                                                    <option key={option} value={option}>{option}</option>
                                                ))}
                                                {!isPitcher && skillOptions.batterType1.map((option) => (
                                                    <option key={option} value={option}>{option}</option>
                                                ))}
                                            </select>
                                        </td>
                                        <td>
                                            <select
                                                value={item.coach2Level}
                                                onChange={(e) => updateRosterItem(category, idx, 'coach2Level', e.target.value)}
                                                disabled={!item.coach2Skill}
                                            >
                                                <option value="">等級</option>
                                                {isPitcher && coachOptions.pitcherCoach2Levels.map((level) => (
                                                    <option key={level} value={level}>{level}</option>
                                                ))}
                                                {!isPitcher && coachOptions.batterCoach2Levels.map((level) => (
                                                    <option key={level} value={level}>{level}</option>
                                                ))}
                                            </select>
                                        </td>
                                        <td>
                                            <input
                                                type="text"
                                                value={item.coach2Note || ''}
                                                onChange={(e) => updateRosterItem(category, idx, 'coach2Note', e.target.value)}
                                                placeholder="備註"
                                                disabled={!item.coach2Skill}
                                            />
                                        </td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                </div>
            );
        };

        const BaseballRosterManager = () => {
            const [clubs, setClubs] = useState([
                { id: 1, name: '俱樂部A', players: [{ id: 1, name: '玩家1', roster: initializeRoster() }] }
            ]);
            const [activeClub, setActiveClub] = useState(0);
            const [activePlayer, setActivePlayer] = useState(0);
            const [showSettings, setShowSettings] = useState(false);
            const [editingClubName, setEditingClubName] = useState(null);

            const [skillOptions, setSkillOptions] = useState({
                pitcherType1: ['工作馬', '精準控球', '速球型投手', '完美先生', '牛棚日', '投手默契', '投手洞察力', '全力投球', '先守後攻'],
                pitcherType2: ['技巧派投手', '壓倒性投手', '大幅局數', '最後大魔王', '交錯之火', '自我解決', '王牌', '鬥志', '王牌終結者', '滾地球投手', '巨人殺手', '投球協調者', '決勝球', '無法碰觸'],
                batterType1: ['精準打擊', '先鋒', '壘球打者', '天生巨星', '打者默契', '打者洞察力', '最強打者', '機會製造者', '老手'],
                batterType2: ['強化優點', '預知能力', '超能神話', '雷射肩', '超級強打', '廣角打者', '讓眾矚目', '五拍子球員', '超級輔助', '王牌殺手', '打擊機器', '盜壘天王', '自走砲']
            });

            const [coachOptions, setCoachOptions] = useState({
                pitcherCoach1: ['壓迫感', '邊角球大師', '亂球', '球棒破壞者', '上升快速球'],
                batterCoach1: ['全壘打', '強打者', '平飛球', '打擊王', '鐵壁守備', '選球眼', '打擊鐵人', '猜球打者'],
                pitcherCoach2Levels: ['I', 'II', 'III'],
                batterCoach2Levels: ['I', 'II', 'III']
            });

            function initializeRoster() {
                return {
                    startingPitchers: Array(5).fill().map((_, i) => ({
                        id: `sp-${i}`,
                        name: '',
                        skill1: '',
                        skill2: '',
                        skill3: '',
                        coach1: '',
                        coach2Skill: '',
                        coach2Level: '',
                        coach2Note: ''
                    })),
                    reliefPitchers: Array(6).fill().map((_, i) => ({
                        id: `rp-${i}`,
                        name: '',
                        skill1: '',
                        skill2: '',
                        skill3: '',
                        coach1: '',
                        coach2Skill: '',
                        coach2Level: '',
                        coach2Note: ''
                    })),
                    batters: Array(9).fill().map((_, i) => ({
                        id: `b-${i}`,
                        name: '',
                        skill1: '',
                        skill2: '',
                        skill3: '',
                        coach1: '',
                        coach2Skill: '',
                        coach2Level: '',
                        coach2Note: ''
                    }))
                };
            }

            const addClub = () => {
                const newClub = {
                    id: clubs.length + 1,
                    name: `俱樂部${String.fromCharCode(65 + clubs.length)}`,
                    players: [{ id: 1, name: '玩家1', roster: initializeRoster() }]
                };
                setClubs([...clubs, newClub]);
                setActiveClub(clubs.length);
                setActivePlayer(0);
            };

            const deleteClub = (index) => {
                if (clubs.length === 1) {
                    alert('至少需要保留一個俱樂部!');
                    return;
                }
                const newClubs = clubs.filter((_, i) => i !== index);
                setClubs(newClubs);
                setActiveClub(Math.max(0, activeClub - 1));
                setActivePlayer(0);
            };

            const addPlayer = () => {
                const newClubs = [...clubs];
                const currentPlayers = newClubs[activeClub].players;
                const newPlayer = {
                    id: currentPlayers.length + 1,
                    name: `玩家${currentPlayers.length + 1}`,
                    roster: initializeRoster()
                };
                newClubs[activeClub].players.push(newPlayer);
                setClubs(newClubs);
                setActivePlayer(currentPlayers.length);
            };

            const deletePlayer = (index) => {
                const newClubs = [...clubs];
                if (newClubs[activeClub].players.length === 1) {
                    alert('每個俱樂部至少需要保留一位玩家!');
                    return;
                }
                newClubs[activeClub].players = newClubs[activeClub].players.filter((_, i) => i !== index);
                setClubs(newClubs);
                setActivePlayer(Math.max(0, activePlayer - 1));
            };

            const updatePlayerName = (index, newName) => {
                const newClubs = [...clubs];
                newClubs[activeClub].players[index].name = newName;
                setClubs(newClubs);
            };

            const updateRosterItem = (category, index, field, value) => {
                const newClubs = [...clubs];
                newClubs[activeClub].players[activePlayer].roster[category][index][field] = value;
                setClubs(newClubs);
            };

            const exportData = () => {
                const workbook = XLSX.utils.book_new();
                const sheetData = [];
                
                // 添加表頭
                sheetData.push(['俱樂部', '玩家', '隊伍', '球員姓名', '位置', '技能1', '技能2', '技能3', '教練1', '教練2']);
                
                // 遍歷所有俱樂部和玩家
                clubs.forEach((club) => {
                    club.players.forEach((player) => {
                        // 先發投手
                        player.roster.startingPitchers.forEach((p, idx) => {
                            const coach2 = p.coach2Skill 
                                ? `${p.coach2Skill}${p.coach2Level ? ' ' + p.coach2Level : ''}${p.coach2Note ? ' (' + p.coach2Note + ')' : ''}`
                                : '';
                            
                            sheetData.push([
                                club.name,
                                player.name,
                                '先發投手',
                                p.name || '',
                                `先發${idx + 1}`,
                                p.skill1 || '',
                                p.skill2 || '',
                                p.skill3 || '',
                                p.coach1 || '',
                                coach2
                            ]);
                        });
                        
                        // 後援投手
                        player.roster.reliefPitchers.forEach((p, idx) => {
                            const coach2 = p.coach2Skill 
                                ? `${p.coach2Skill}${p.coach2Level ? ' ' + p.coach2Level : ''}${p.coach2Note ? ' (' + p.coach2Note + ')' : ''}`
                                : '';
                            
                            sheetData.push([
                                club.name,
                                player.name,
                                '後援投手',
                                p.name || '',
                                `後援${idx + 1}`,
                                p.skill1 || '',
                                p.skill2 || '',
                                p.skill3 || '',
                                p.coach1 || '',
                                coach2
                            ]);
                        });
                        
                        // 打者陣容
                        player.roster.batters.forEach((b, idx) => {
                            const coach2 = b.coach2Skill 
                                ? `${b.coach2Skill}${b.coach2Level ? ' ' + b.coach2Level : ''}${b.coach2Note ? ' (' + b.coach2Note + ')' : ''}`
                                : '';
                            
                            sheetData.push([
                                club.name,
                                player.name,
                                '打者',
                                b.name || '',
                                `${idx + 1}棒`,
                                b.skill1 || '',
                                b.skill2 || '',
                                b.skill3 || '',
                                b.coach1 || '',
                                coach2
                            ]);
                        });
                    });
                });
                
                // 創建工作表
                const worksheet = XLSX.utils.aoa_to_sheet(sheetData);
                
                // 設置列寬
                worksheet['!cols'] = [
                    { wch: 12 },  // 俱樂部
                    { wch: 12 },  // 玩家
                    { wch: 12 },  // 隊伍
                    { wch: 20 },  // 球員姓名
                    { wch: 10 },  // 位置
                    { wch: 15 },  // 技能1
                    { wch: 15 },  // 技能2
                    { wch: 15 },  // 技能3
                    { wch: 15 },  // 教練1
                    { wch: 25 }   // 教練2
                ];
                
                XLSX.utils.book_append_sheet(workbook, worksheet, '球員陣容');
                
                // 匯出檔案
                XLSX.writeFile(workbook, 'baseball_roster_data.xlsx');
            };

            const SettingsModal = () => {
                const [newSkill, setNewSkill] = useState('');
                const [newCoach, setNewCoach] = useState('');
                const [selectedSkillType, setSelectedSkillType] = useState('pitcherType1');
                const [selectedCoachType, setSelectedCoachType] = useState('pitcherCoach1');

                const addSkill = () => {
                    if (newSkill.trim()) {
                        setSkillOptions({
                            ...skillOptions,
                            [selectedSkillType]: [...skillOptions[selectedSkillType], newSkill.trim()]
                        });
                        setNewSkill('');
                    }
                };

                const removeSkill = (type, skill) => {
                    setSkillOptions({
                        ...skillOptions,
                        [type]: skillOptions[type].filter(s => s !== skill)
                    });
                };

                const addCoach = () => {
                    if (newCoach.trim()) {
                        setCoachOptions({
                            ...coachOptions,
                            [selectedCoachType]: [...coachOptions[selectedCoachType], newCoach.trim()]
                        });
                        setNewCoach('');
                    }
                };

                const removeCoach = (type, coach) => {
                    setCoachOptions({
                        ...coachOptions,
                        [type]: coachOptions[type].filter(c => c !== coach)
                    });
                };

                if (!showSettings) return null;

                return (
                    <div className="modal">
                        <div className="modal-content">
                            <div className="modal-header">
                                <h2 className="modal-title">技能與教練設定</h2>
                                <button className="close-btn" onClick={() => setShowSettings(false)}>×</button>
                            </div>

                            <div className="settings-section">
                                <h3 className="settings-title">技能選項</h3>
                                
                                <div className="input-group">
                                    <select
                                        value={selectedSkillType}
                                        onChange={(e) => setSelectedSkillType(e.target.value)}
                                        style={{ width: 'auto' }}
                                    >
                                        <option value="pitcherType1">投手黑技</option>
                                        <option value="pitcherType2">投手金技</option>
                                        <option value="batterType1">打者黑技</option>
                                        <option value="batterType2">打者金技</option>
                                    </select>
                                    <input
                                        type="text"
                                        value={newSkill}
                                        onChange={(e) => setNewSkill(e.target.value)}
                                        onKeyPress={(e) => e.key === 'Enter' && addSkill()}
                                        placeholder="新增技能"
                                        style={{ flex: 1 }}
                                    />
                                    <button onClick={addSkill} className="btn btn-primary">新增</button>
                                </div>

                                <div className="skill-grid">
                                    {Object.entries(skillOptions).map(([type, skills]) => (
                                        <div key={type} className="skill-card">
                                            <h4 className="skill-card-title">
                                                {type === 'pitcherType1' ? '投手黑技' :
                                                 type === 'pitcherType2' ? '投手金技' :
                                                 type === 'batterType1' ? '打者黑技' : '打者金技'}
                                            </h4>
                                            {skills.map((skill) => (
                                                <div key={skill} className="skill-item">
                                                    <span style={{ fontSize: '0.875rem' }}>{skill}</span>
                                                    <button onClick={() => removeSkill(type, skill)} className="delete-btn">
                                                        刪除
                                                    </button>
                                                </div>
                                            ))}
                                        </div>
                                    ))}
                                </div>
                            </div>

                            <div className="settings-section">
                                <h3 className="settings-title">教練1選項</h3>
                                
                                <div className="input-group">
                                    <select
                                        value={selectedCoachType}
                                        onChange={(e) => setSelectedCoachType(e.target.value)}
                                        style={{ width: 'auto' }}
                                    >
                                        <option value="pitcherCoach1">投手教練1</option>
                                        <option value="batterCoach1">打者教練1</option>
                                    </select>
                                    <input
                                        type="text"
                                        value={newCoach}
                                        onChange={(e) => setNewCoach(e.target.value)}
                                        onKeyPress={(e) => e.key === 'Enter' && addCoach()}
                                        placeholder="新增教練選項"
                                        style={{ flex: 1 }}
                                    />
                                    <button onClick={addCoach} className="btn btn-success">新增</button>
                                </div>

                                <div className="skill-grid">
                                    <div className="skill-card">
                                        <h4 className="skill-card-title">投手教練1</h4>
                                        {coachOptions.pitcherCoach1.map((coach) => (
                                            <div key={coach} className="skill-item">
                                                <span>{coach}</span>
                                                <button onClick={() => removeCoach('pitcherCoach1', coach)} className="delete-btn">
                                                    刪除
                                                </button>
                                            </div>
                                        ))}
                                    </div>
                                    <div className="skill-card">
                                        <h4 className="skill-card-title">打者教練1</h4>
                                        {coachOptions.batterCoach1.map((coach) => (
                                            <div key={coach} className="skill-item">
                                                <span>{coach}</span>
                                                <button onClick={() => removeCoach('batterCoach1', coach)} className="delete-btn">
                                                    刪除
                                                </button>
                                            </div>
                                        ))}
                                    </div>
                                </div>

                                <div style={{ marginTop: '1rem', padding: '1rem', background: '#f0f9ff', borderRadius: '0.5rem' }}>
                                    <h4 style={{ fontWeight: 600, marginBottom: '0.5rem', color: '#1e40af' }}>教練2說明</h4>
                                    <ul style={{ paddingLeft: '1.5rem', fontSize: '0.875rem', color: '#374151' }}>
                                        <li>投手教練2:對應投手黑技,需選擇等級 (I/II/III) 和備註</li>
                                        <li>打者教練2:對應打者黑技,需選擇等級 (I/II/III) 和備註</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            };

            return (
                <div className="container">
                    <div className="card">
                        <div className="header">
                            <h1 className="title">⚾ 棒球遊戲球員管理系統</h1>
                            <div className="flex-gap">
                                <button onClick={() => setShowSettings(true)} className="btn btn-purple">
                                    ⚙️ 設定
                                </button>
                                <button onClick={exportData} className="btn btn-success">
                                    📊 匯出Excel
                                </button>
                            </div>
                        </div>

                        <div className="section-row">
                            <span className="label">俱樂部:</span>
                            <div className="tabs">
                                {clubs.map((club, index) => (
                                    <div key={club.id} className="flex-gap">
                                        {editingClubName === index ? (
                                            <div className="flex-gap">
                                                <input
                                                    type="text"
                                                    value={club.name}
                                                    onChange={(e) => {
                                                        const newClubs = [...clubs];
                                                        newClubs[index].name = e.target.value;
                                                        setClubs(newClubs);
                                                    }}
                                                    onKeyPress={(e) => {
                                                        if (e.key === 'Enter') setEditingClubName(null);
                                                    }}
                                                    className="edit-input"
                                                    autoFocus
                                                    style={{ width: '150px' }}
                                                />
                                                <button
                                                    onClick={() => setEditingClubName(null)}
                                                    className="btn btn-primary btn-sm"
                                                >
                                                    ✓
                                                </button>
                                            </div>
                                        ) : (
                                            <>
                                                <button
                                                    onClick={() => {
                                                        setActiveClub(index);
                                                        setActivePlayer(0);
                                                    }}
                                                    className={`tab ${activeClub === index ? 'active' : 'inactive'}`}
                                                >
                                                    {club.name}
                                                </button>
                                                <button
                                                    onClick={() => setEditingClubName(index)}
                                                    className="btn btn-secondary btn-sm"
                                                >
                                                    ✏️
                                                </button>
                                                {clubs.length > 1 && (
                                                    <button
                                                        onClick={() => deleteClub(index)}
                                                        className="btn btn-secondary btn-sm"
                                                        style={{ color: '#dc2626' }}
                                                    >
                                                        🗑️
                                                    </button>
                                                )}
                                            </>
                                        )}
                                    </div>
                                ))}
                                <button onClick={addClub} className="btn btn-light-blue">
                                    ➕ 新增俱樂部
                                </button>
                            </div>
                        </div>

                        <div className="section-row">
                            <span className="label">玩家:</span>
                            <div className="tabs">
                                {clubs[activeClub].players.map((player, index) => (
                                    <div key={`player-${player.id}`} className="flex-gap">
                                        <button
                                            onClick={() => setActivePlayer(index)}
                                            className={`tab player ${activePlayer === index ? 'active' : 'inactive'}`}
                                        >
                                            {player.name}
                                        </button>
                                        <button
                                            onClick={() => {
                                                const newName = prompt('請輸入玩家名稱:', player.name);
                                                if (newName !== null && newName.trim() !== '') {
                                                    updatePlayerName(index, newName.trim());
                                                }
                                            }}
                                            className="btn btn-secondary btn-sm"
                                        >
                                            ✏️
                                        </button>
                                        {clubs[activeClub].players.length > 1 && (
                                            <button
                                                onClick={() => deletePlayer(index)}
                                                className="btn btn-secondary btn-sm"
                                                style={{ color: '#dc2626' }}
                                            >
                                                🗑️
                                            </button>
                                        )}
                                    </div>
                                ))}
                                <button onClick={addPlayer} className="btn btn-light-green">
                                    ➕ 新增玩家
                                </button>
                            </div>
                        </div>
                    </div>

                    <div className="card">
                        <h2 style={{ fontSize: '1.5rem', fontWeight: 'bold', marginBottom: '1.5rem', color: '#1f2937' }}>
                            {clubs[activeClub].name} - {clubs[activeClub].players[activePlayer].name} 的陣容
                        </h2>
                        
                        <RosterSection 
                            title="先發投手" 
                            category="startingPitchers" 
                            count={5} 
                            isPitcher={true}
                            roster={clubs[activeClub].players[activePlayer].roster.startingPitchers}
                            updateRosterItem={updateRosterItem}
                            skillOptions={skillOptions}
                            coachOptions={coachOptions}
                        />
                        <RosterSection 
                            title="後援投手" 
                            category="reliefPitchers" 
                            count={6} 
                            isPitcher={true}
                            roster={clubs[activeClub].players[activePlayer].roster.reliefPitchers}
                            updateRosterItem={updateRosterItem}
                            skillOptions={skillOptions}
                            coachOptions={coachOptions}
                        />
                        <RosterSection 
                            title="打者陣容" 
                            category="batters" 
                            count={9} 
                            isPitcher={false}
                            roster={clubs[activeClub].players[activePlayer].roster.batters}
                            updateRosterItem={updateRosterItem}
                            skillOptions={skillOptions}
                            coachOptions={coachOptions}
                        />
                    </div>

                    <SettingsModal />
                </div>
            );
        };

        ReactDOM.render(<BaseballRosterManager />, document.getElementById('root'));
    </script>
</body>
</html>